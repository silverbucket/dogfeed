/*! built for Dogfeed 2014-09-10 */
!function(){var a="articles";RemoteStorage.defineModule(a,function(b){var c=function(a){function b(a,b){var c=a[0],h=a[1],i=a[2],j=a[3];c=d(c,h,i,j,b[0],7,-680876936),j=d(j,c,h,i,b[1],12,-389564586),i=d(i,j,c,h,b[2],17,606105819),h=d(h,i,j,c,b[3],22,-1044525330),c=d(c,h,i,j,b[4],7,-176418897),j=d(j,c,h,i,b[5],12,1200080426),i=d(i,j,c,h,b[6],17,-1473231341),h=d(h,i,j,c,b[7],22,-45705983),c=d(c,h,i,j,b[8],7,1770035416),j=d(j,c,h,i,b[9],12,-1958414417),i=d(i,j,c,h,b[10],17,-42063),h=d(h,i,j,c,b[11],22,-1990404162),c=d(c,h,i,j,b[12],7,1804603682),j=d(j,c,h,i,b[13],12,-40341101),i=d(i,j,c,h,b[14],17,-1502002290),h=d(h,i,j,c,b[15],22,1236535329),c=e(c,h,i,j,b[1],5,-165796510),j=e(j,c,h,i,b[6],9,-1069501632),i=e(i,j,c,h,b[11],14,643717713),h=e(h,i,j,c,b[0],20,-373897302),c=e(c,h,i,j,b[5],5,-701558691),j=e(j,c,h,i,b[10],9,38016083),i=e(i,j,c,h,b[15],14,-660478335),h=e(h,i,j,c,b[4],20,-405537848),c=e(c,h,i,j,b[9],5,568446438),j=e(j,c,h,i,b[14],9,-1019803690),i=e(i,j,c,h,b[3],14,-187363961),h=e(h,i,j,c,b[8],20,1163531501),c=e(c,h,i,j,b[13],5,-1444681467),j=e(j,c,h,i,b[2],9,-51403784),i=e(i,j,c,h,b[7],14,1735328473),h=e(h,i,j,c,b[12],20,-1926607734),c=f(c,h,i,j,b[5],4,-378558),j=f(j,c,h,i,b[8],11,-2022574463),i=f(i,j,c,h,b[11],16,1839030562),h=f(h,i,j,c,b[14],23,-35309556),c=f(c,h,i,j,b[1],4,-1530992060),j=f(j,c,h,i,b[4],11,1272893353),i=f(i,j,c,h,b[7],16,-155497632),h=f(h,i,j,c,b[10],23,-1094730640),c=f(c,h,i,j,b[13],4,681279174),j=f(j,c,h,i,b[0],11,-358537222),i=f(i,j,c,h,b[3],16,-722521979),h=f(h,i,j,c,b[6],23,76029189),c=f(c,h,i,j,b[9],4,-640364487),j=f(j,c,h,i,b[12],11,-421815835),i=f(i,j,c,h,b[15],16,530742520),h=f(h,i,j,c,b[2],23,-995338651),c=g(c,h,i,j,b[0],6,-198630844),j=g(j,c,h,i,b[7],10,1126891415),i=g(i,j,c,h,b[14],15,-1416354905),h=g(h,i,j,c,b[5],21,-57434055),c=g(c,h,i,j,b[12],6,1700485571),j=g(j,c,h,i,b[3],10,-1894986606),i=g(i,j,c,h,b[10],15,-1051523),h=g(h,i,j,c,b[1],21,-2054922799),c=g(c,h,i,j,b[8],6,1873313359),j=g(j,c,h,i,b[15],10,-30611744),i=g(i,j,c,h,b[6],15,-1560198380),h=g(h,i,j,c,b[13],21,1309151649),c=g(c,h,i,j,b[4],6,-145523070),j=g(j,c,h,i,b[11],10,-1120210379),i=g(i,j,c,h,b[2],15,718787259),h=g(h,i,j,c,b[9],21,-343485551),a[0]=m(c,a[0]),a[1]=m(h,a[1]),a[2]=m(i,a[2]),a[3]=m(j,a[3])}function c(a,b,c,d,e,f){return b=m(m(b,a),m(d,f)),m(b<<e|b>>>32-e,c)}function d(a,b,d,e,f,g,h){return c(b&d|~b&e,a,b,f,g,h)}function e(a,b,d,e,f,g,h){return c(b&e|d&~e,a,b,f,g,h)}function f(a,b,d,e,f,g,h){return c(b^d^e,a,b,f,g,h)}function g(a,b,d,e,f,g,h){return c(d^(b|~e),a,b,f,g,h)}function h(a){txt="";var c,d=a.length,e=[1732584193,-271733879,-1732584194,271733878];for(c=64;c<=a.length;c+=64)b(e,i(a.substring(c-64,c)));a=a.substring(c-64);var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(c=0;c<a.length;c++)f[c>>2]|=a.charCodeAt(c)<<(c%4<<3);if(f[c>>2]|=128<<(c%4<<3),c>55)for(b(e,f),c=0;16>c;c++)f[c]=0;return f[14]=8*d,b(e,f),e}function i(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function j(a){for(var b="",c=0;4>c;c++)b+=n[a>>8*c+4&15]+n[a>>8*c&15];return b}function k(a){for(var b=0;b<a.length;b++)a[b]=j(a[b]);return a.join("")}function l(a){return k(h(a))}function m(a,b){return a+b&4294967295}function m(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}var n="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=l("hello"),l(a)};return{exports:{init:function(){b.declareType(a,{description:"collections of articles, typically retreived from RSS feeds",key:"link",type:"object",properties:{id:{type:"string",description:"md5sum of link as ID",required:!0},link:{type:"string",description:"link to the article",required:!0,format:"uri"},title:{type:"string",description:"human readable name article",required:!1},date:{type:"string",description:"date of article",required:!1},datenum:{type:"number",description:"converted date to number",required:!0},html:{type:"string",description:"html content of the article",required:!1},text:{type:"string",description:"text content of the article",required:!1},brief_html:{type:"string",description:"a brief blurb of the article, in html",required:!1},brief_text:{type:"string",description:"a brief blurb of the article, in text",required:!1},read:{type:"boolean",description:"flag if the article has been read or not",required:!0},source_link:{type:"string",description:"link to the source feed that this article may have been linked from",required:!1,format:"uri"},source_title:{type:"string",description:"human readable name  of the source feed that this article may have been linked from",required:!1}}})},on:b.on.bind(b),remove:b.remove.bind(b),update:function(d){return d.id="string"==typeof d.link?c(d.link):b.uuid(),"undefined"==typeof d.read&&(d.read=!1),b.storeObject(a,d.id,d)},getByUrl:function(a){return b.getObject(c(a))},getAll:b.getAll.bind(b),getListing:b.getListing.bind(b)}}})}(),function(){var a="feeds";RemoteStorage.defineModule(a,function(b){var c=function(a){function b(a,b){var c=a[0],h=a[1],i=a[2],j=a[3];c=d(c,h,i,j,b[0],7,-680876936),j=d(j,c,h,i,b[1],12,-389564586),i=d(i,j,c,h,b[2],17,606105819),h=d(h,i,j,c,b[3],22,-1044525330),c=d(c,h,i,j,b[4],7,-176418897),j=d(j,c,h,i,b[5],12,1200080426),i=d(i,j,c,h,b[6],17,-1473231341),h=d(h,i,j,c,b[7],22,-45705983),c=d(c,h,i,j,b[8],7,1770035416),j=d(j,c,h,i,b[9],12,-1958414417),i=d(i,j,c,h,b[10],17,-42063),h=d(h,i,j,c,b[11],22,-1990404162),c=d(c,h,i,j,b[12],7,1804603682),j=d(j,c,h,i,b[13],12,-40341101),i=d(i,j,c,h,b[14],17,-1502002290),h=d(h,i,j,c,b[15],22,1236535329),c=e(c,h,i,j,b[1],5,-165796510),j=e(j,c,h,i,b[6],9,-1069501632),i=e(i,j,c,h,b[11],14,643717713),h=e(h,i,j,c,b[0],20,-373897302),c=e(c,h,i,j,b[5],5,-701558691),j=e(j,c,h,i,b[10],9,38016083),i=e(i,j,c,h,b[15],14,-660478335),h=e(h,i,j,c,b[4],20,-405537848),c=e(c,h,i,j,b[9],5,568446438),j=e(j,c,h,i,b[14],9,-1019803690),i=e(i,j,c,h,b[3],14,-187363961),h=e(h,i,j,c,b[8],20,1163531501),c=e(c,h,i,j,b[13],5,-1444681467),j=e(j,c,h,i,b[2],9,-51403784),i=e(i,j,c,h,b[7],14,1735328473),h=e(h,i,j,c,b[12],20,-1926607734),c=f(c,h,i,j,b[5],4,-378558),j=f(j,c,h,i,b[8],11,-2022574463),i=f(i,j,c,h,b[11],16,1839030562),h=f(h,i,j,c,b[14],23,-35309556),c=f(c,h,i,j,b[1],4,-1530992060),j=f(j,c,h,i,b[4],11,1272893353),i=f(i,j,c,h,b[7],16,-155497632),h=f(h,i,j,c,b[10],23,-1094730640),c=f(c,h,i,j,b[13],4,681279174),j=f(j,c,h,i,b[0],11,-358537222),i=f(i,j,c,h,b[3],16,-722521979),h=f(h,i,j,c,b[6],23,76029189),c=f(c,h,i,j,b[9],4,-640364487),j=f(j,c,h,i,b[12],11,-421815835),i=f(i,j,c,h,b[15],16,530742520),h=f(h,i,j,c,b[2],23,-995338651),c=g(c,h,i,j,b[0],6,-198630844),j=g(j,c,h,i,b[7],10,1126891415),i=g(i,j,c,h,b[14],15,-1416354905),h=g(h,i,j,c,b[5],21,-57434055),c=g(c,h,i,j,b[12],6,1700485571),j=g(j,c,h,i,b[3],10,-1894986606),i=g(i,j,c,h,b[10],15,-1051523),h=g(h,i,j,c,b[1],21,-2054922799),c=g(c,h,i,j,b[8],6,1873313359),j=g(j,c,h,i,b[15],10,-30611744),i=g(i,j,c,h,b[6],15,-1560198380),h=g(h,i,j,c,b[13],21,1309151649),c=g(c,h,i,j,b[4],6,-145523070),j=g(j,c,h,i,b[11],10,-1120210379),i=g(i,j,c,h,b[2],15,718787259),h=g(h,i,j,c,b[9],21,-343485551),a[0]=m(c,a[0]),a[1]=m(h,a[1]),a[2]=m(i,a[2]),a[3]=m(j,a[3])}function c(a,b,c,d,e,f){return b=m(m(b,a),m(d,f)),m(b<<e|b>>>32-e,c)}function d(a,b,d,e,f,g,h){return c(b&d|~b&e,a,b,f,g,h)}function e(a,b,d,e,f,g,h){return c(b&e|d&~e,a,b,f,g,h)}function f(a,b,d,e,f,g,h){return c(b^d^e,a,b,f,g,h)}function g(a,b,d,e,f,g,h){return c(d^(b|~e),a,b,f,g,h)}function h(a){txt="";var c,d=a.length,e=[1732584193,-271733879,-1732584194,271733878];for(c=64;c<=a.length;c+=64)b(e,i(a.substring(c-64,c)));a=a.substring(c-64);var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(c=0;c<a.length;c++)f[c>>2]|=a.charCodeAt(c)<<(c%4<<3);if(f[c>>2]|=128<<(c%4<<3),c>55)for(b(e,f),c=0;16>c;c++)f[c]=0;return f[14]=8*d,b(e,f),e}function i(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function j(a){for(var b="",c=0;4>c;c++)b+=n[a>>8*c+4&15]+n[a>>8*c&15];return b}function k(a){for(var b=0;b<a.length;b++)a[b]=j(a[b]);return a.join("")}function l(a){return k(h(a))}function m(a,b){return a+b&4294967295}function m(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}var n="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=l("hello"),l(a)};return{exports:{init:function(){b.declareType(a,{description:"RSS Feed URLs and related settings",key:"id",type:"object",properties:{id:{type:"string",description:"md5sum of link as ID",required:!0},url:{type:"string",description:"URL of the RSS feed",required:!0,format:"uri"},name:{type:"string",description:"human readable name of feed",required:!1},description:{type:"string",description:"human readable description of feed",required:!1},image:{type:"string",description:"url of feed image (logo)",required:!1},favicon:{type:"string",description:"url of feeds favicon",required:!1},language:{type:"string",description:"language of feed",required:!1},author:{type:"string",description:"author of feed",required:!1},cache_articles:{type:"number",description:"number of articles to store",required:!1},last_fetched:{type:"number",description:"last time feed was fetched",required:!1},date_added:{type:"number",description:"date feed was added",required:!0},date_updated:{type:"number",description:"date feed was added",required:!0}}})},on:b.on.bind(b),remove:function(a){return"string"!=typeof a?!1:(a=c(a),b.remove(a))},add:function(d){return"string"!=typeof d.url?!1:(d.id=c(d.url),d.date_added||(d.date_added=(new Date).getTime()),d.date_updated=(new Date).getTime(),b.storeObject(a,d.id,d))},md5sum:c,get:b.getObject.bind(b),getAll:b.getAll.bind(b),getListing:b.getListing.bind(b)}}})}(),function(a){function b(a){function c(a){if(f){var b;if(a.fulfilled)try{b=[a.fulfilled.apply(null,g)]}catch(c){return void a.promise.reject(c)}else b=g;b[0]&&"function"==typeof b[0].then?b[0].then(a.promise.fulfill,a.promise.reject):a.promise.fulfill.apply(null,b)}else if(a.rejected){var d;try{d=a.rejected.apply(null,g)}catch(c){return void a.promise.reject(c)}d&&"function"==typeof d.then?d.then(a.promise.fulfill,a.promise.reject):a.promise.fulfill(d)}else a.promise.reject.apply(null,g)}function d(a,b){return g?void console.error("WARNING: Can't resolve promise, already resolved!"):(f=a,g=Array.prototype.slice.call(b),void setTimeout(function(){var a=h.length;0!==a||f||console.error("Possibly uncaught error: ",g,g[0]&&g[0].stack);for(var b=0;a>b;b++)c(h[b]);h=void 0},0))}var e;"function"==typeof a&&setTimeout(function(){try{a(e)}catch(b){e.reject(b)}},0);var f,g,h=[];return e={then:function(a,d){var e={fulfilled:"function"==typeof a?a:void 0,rejected:"function"==typeof d?d:void 0,promise:b()};return g?setTimeout(function(){c(e)},0):h.push(e),e.promise},fulfill:function(){return d(!0,arguments),this},reject:function(){return d(!1,arguments),this}}}a.promising=b}("undefined"!=typeof window?window:global),function(a){function b(a){"string"==typeof a?console.error(a):console.error(a.message,a.stack)}function c(a){var b=Array.prototype.slice.call(arguments);(403===a||401===a)&&this._emit("error",new f.Unauthorized);var c=promising();return c.fulfill.apply(c,b)}function d(a){return"dropbox"===this.backend&&a.match(/^\/public\/.*[^\/]$/)}var e={get:function(a,b){if(this.local){void 0===b&&(b=this.connected?2*this.getSyncInterval():!1);var c=function(a){return a!==!1&&"number"!=typeof a};if(c(b)){var d=promising();return d.reject("Argument 'maxAge' must be false or a number"),d}return this.local.get(a,b,this.sync.queueGetRequest.bind(this.sync))}return this.remote.get(a)},put:function(a,b,c){return d.bind(this)(a)?e._wrapBusyDone.call(this,this.remote.put(a,b,c)):this.local?this.local.put(a,b,c):e._wrapBusyDone.call(this,this.remote.put(a,b,c))},"delete":function(a){return this.local?this.local.delete(a):e._wrapBusyDone.call(this,this.remote.delete(a))},_wrapBusyDone:function(a){var b=this;return this._emit("wire-busy"),a.then(function(){var a=promising();return b._emit("wire-done",{success:!0}),a.fulfill.apply(a,arguments)},function(a){throw b._emit("wire-done",{success:!1}),a})}},f=function(){if(f.eventHandling(this,"ready","connected","disconnected","not-connected","conflict","error","features-loaded","connecting","authing","wire-busy","wire-done","sync-interval-change"),this._pending=[],this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),"delete":this._pendingGPD("delete")}),this._cleanups=[],this._pathHandlers={change:{}},this.apiKeys={},this.localStorageAvailable()){try{this.apiKeys=JSON.parse(localStorage["remotestorage:api-keys"])}catch(a){}this.setBackend(localStorage["remotestorage:backend"]||"remotestorage")}var b=this.on;this.on=function(a,c){return"ready"===a&&this.remote.connected&&this._allLoaded?setTimeout(c,0):"features-loaded"===a&&this._allLoaded&&setTimeout(c,0),b.call(this,a,c)},this._init(),this.fireInitial=function(){this.local&&setTimeout(this.local.fireInitial.bind(this.local),0)}.bind(this),this.on("ready",this.fireInitial.bind(this))};f.SyncedGetPutDelete=e,f.DiscoveryError=function(a){Error.apply(this,arguments),this.message=a},f.DiscoveryError.prototype=Object.create(Error.prototype),f.Unauthorized=function(){Error.apply(this,arguments)},f.Unauthorized.prototype=Object.create(Error.prototype),f.log=function(){f.config.logging&&console.log.apply(console,arguments)},f.config={logging:!1,changeEvents:{local:!0,window:!1,remote:!0,conflict:!0},discoveryTimeout:1e4},f.prototype={connect:function(a){if(this.setBackend("remotestorage"),a.indexOf("@")<0)return void this._emit("error",new f.DiscoveryError("User address doesn't contain an @."));this.remote.configure(a),this._emit("connecting");var b=setTimeout(function(){this._emit("error",new f.DiscoveryError("No storage information found at that user address."))}.bind(this),f.config.discoveryTimeout);f.Discover(a,function(c,d,e){return clearTimeout(b),c?(this._emit("authing"),this.remote.configure(a,c,d),void(this.remote.connected||(e?this.authorize(e):this.impliedauth()))):void this._emit("error",new f.DiscoveryError("Failed to contact storage server."))}.bind(this))},disconnect:function(){this.remote&&this.remote.configure(null,null,null,null),this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),"delete":this._pendingGPD("delete")});var a=this._cleanups.length,b=0,c=function(){b++,b>=a&&(this._init(),f.log("Done cleaning up, emitting disconnected and disconnect events"),this._emit("disconnected"))}.bind(this);a>0?this._cleanups.forEach(function(a){var b=a(this);"object"==typeof a&&"function"==typeof a.then?b.then(c):c()}.bind(this)):c()},setBackend:function(a){this.backend=a,this.localStorageAvailable()&&(a?localStorage["remotestorage:backend"]=a:delete localStorage["remotestorage:backend"])},onChange:function(a,b){this._pathHandlers.change[a]||(this._pathHandlers.change[a]=[]),this._pathHandlers.change[a].push(b)},enableLog:function(){f.config.logging=!0},disableLog:function(){f.config.logging=!1},log:function(){f.log.apply(f,arguments)},setApiKeys:function(a,b){b?this.apiKeys[a]=b:delete this.apiKeys[a],this.localStorageAvailable()&&(localStorage["remotestorage:api-keys"]=JSON.stringify(this.apiKeys))},_init:function(){function a(){try{d||(c._emit("ready"),d=!0)}catch(a){console.error("'ready' failed: ",a,a.stack),c._emit("error",a)}}var c=this,d=!1;this._loadFeatures(function(d){this.log("[RemoteStorage] All features loaded"),this.local=d.local&&new d.local,this.local&&this.remote?(this._setGPD(e,this),this._bindChange(this.local)):this.remote&&this._setGPD(this.remote,this.remote),this.remote&&(this.remote.on("connected",function(){a(),c._emit("connected")}),this.remote.on("not-connected",function(){a(),c._emit("not-connected")}),this.remote.connected&&(a(),c._emit("connected"))),this._collectCleanupFunctions();try{this._allLoaded=!0,this._emit("features-loaded")}catch(f){b(f),this._emit("error",f)}this._processPending()}.bind(this))},_collectCleanupFunctions:function(){for(var a=0;a<this.features.length;a++){var b=this.features[a].cleanup;"function"==typeof b&&this._cleanups.push(b)}},_loadFeatures:function(a){function b(){j++,j===h.length&&setTimeout(function(){i.caching=!!f.Caching,i.sync=!!f.Sync,["IndexedDB","LocalStorage","InMemoryStorage"].some(function(a){return i.some(function(b){return b.name===a})?(i.local=f[a],!0):void 0}),k.features=i,a(i)},0)}function c(a){k.log("[RemoteStorage] [FEATURE "+a+"] initialized."),i.push({name:a,init:f[a]._rs_init,supported:!0,cleanup:f[a]._rs_cleanup}),b()}function d(a,c){k.log("[RemoteStorage] [FEATURE "+a+"] initialization failed ( "+c+")"),b()}function e(a,c){k.log("[RemoteStorage] [FEATURE "+a+"]"+c?"":" not supported"),c||b()}function g(a){var b;try{b=f[a]._rs_init(k)}catch(e){return void d(a,e)}"object"==typeof b&&"function"==typeof b.then?b.then(function(){c(a)},function(b){d(a,b)}):c(a)}var h=["WireClient","I18n","Dropbox","GoogleDrive","Access","Caching","Discover","Authorize","Widget","IndexedDB","LocalStorage","InMemoryStorage","Sync","BaseClient","Env"],i=[],j=0,k=this;h.forEach(function(a){k.log("[RemoteStorage] [FEATURE "+a+"] initializing...");var b,c=f[a];c?(b=!c._rs_supported||c._rs_supported(),"object"==typeof b?b.then(function(){e(a,!0),g(a)},function(){e(a,!1)}):"boolean"==typeof b&&(e(a,b),b&&g(a))):e(a,!1)})},localStorageAvailable:function(){try{return!!a.localStorage}catch(b){return!1}},_setGPD:function(a,b){function d(a){return function(){return a.apply(b,arguments).then(c.bind(this))}}this.get=d(a.get),this.put=d(a.put),this.delete=d(a.delete)},_pendingGPD:function(a){return function(){var b=promising();return this._pending.push({method:a,args:Array.prototype.slice.call(arguments),promise:b}),b}.bind(this)},_processPending:function(){this._pending.forEach(function(a){try{this[a.method].apply(this,a.args).then(a.promise.fulfill,a.promise.reject)}catch(b){a.promise.reject(b)}}.bind(this)),this._pending=[]},_bindChange:function(a){a.on("change",this._dispatchEvent.bind(this,"change"))},_dispatchEvent:function(a,b){for(var c in this._pathHandlers[a]){var d=c.length,e=this;b.path.substr(0,d)===c&&this._pathHandlers[a][c].forEach(function(a){var d={};for(var f in b)d[f]=b[f];d.relativePath=b.path.replace(new RegExp("^"+c),"");try{a(d)}catch(g){console.error("'change' handler failed: ",g,g.stack),e._emit("error",g)}})}}},Object.defineProperty(f.prototype,"connected",{get:function(){return this.remote.connected}}),a.RemoteStorage=f}("undefined"!=typeof window?window:global),function(){var a={addEventListener:function(a,b){if("string"!=typeof a)throw new Error("Argument eventName should be a string");if("function"!=typeof b)throw new Error("Argument handler should be a function");RemoteStorage.log("[Eventhandling] Adding event listener",a,b),this._validateEvent(a),this._handlers[a].push(b)},removeEventListener:function(a,b){this._validateEvent(a);for(var c=this._handlers[a].length,d=0;c>d;d++)if(this._handlers[a][d]===b)return void this._handlers[a].splice(d,1)},_emit:function(a){this._validateEvent(a);var b=Array.prototype.slice.call(arguments,1);this._handlers[a].forEach(function(a){a.apply(this,b)})},_validateEvent:function(a){if(!(a in this._handlers))throw new Error("Unknown event: "+a)},_delegateEvent:function(a,b){b.on(a,function(b){this._emit(a,b)}.bind(this))},_addEvent:function(a){this._handlers[a]=[]}};a.on=a.addEventListener,RemoteStorage.eventHandling=function(b){var c=Array.prototype.slice.call(arguments,1);for(var d in a)b[d]=a[d];b._handlers={},c.forEach(function(a){b._addEvent(a)})}}("undefined"!=typeof window?window:global),function(a){function b(a){return"string"!=typeof a?a:"*"===a?"*":'"'+a+'"'}function c(a){return"string"!=typeof a?a:a.replace(/^["']|["']$/g,"")}function d(a,b,c){var d=new Blob([a],{type:b}),e=new FileReader;e.addEventListener("loadend",function(){c(e.result)}),e.readAsArrayBuffer(d)}function e(a,b,c){if("undefined"==typeof Blob){var d=new Buffer(new Uint8Array(a));c(d.toString(b))}else{var e=new Blob([a]),f=new FileReader;f.addEventListener("loadend",function(a){c(a.target.result)}),f.readAsText(e,b)}}function f(a){var b,c="UTF-8";return a&&(b=a.match(/charset=(.+)$/),b&&(c=b[1])),c}function g(a){return a.replace(/\/+/g,"/").split("/").map(encodeURIComponent).join("/")}function h(a){return"/"===a.substr(-1)}function i(a){return"http://remotestorage.io/spec/folder-description"===a["@context"]&&"object"==typeof a.items}function j(a){return[201,204,304].indexOf(a)>=0}function k(a){return[401,403,404,412].indexOf(a)>=0}var l,m,n=RemoteStorage,o="remotestorage:wireclient",p=1,q=2,r=3,s=4,t=5,u={"draft-dejong-remotestorage-00":q,"draft-dejong-remotestorage-01":r,"draft-dejong-remotestorage-02":s,"https://www.w3.org/community/rww/wiki/read-write-web-00#simple":p};if("function"==typeof ArrayBufferView)m=function(a){return a&&a instanceof ArrayBufferView};else{var v=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];m=function(a){for(var b=0;8>b;b++)if(a instanceof v[b])return!0;return!1}}var w;n.WireClient=function(a){if(this.connected=!1,n.eventHandling(this,"change","connected","wire-busy","wire-done","not-connected"),w=function(a){a instanceof RemoteStorage.SyncError?this.online=!1:a instanceof RemoteStorage.Unauthorized&&this.configure(void 0,void 0,void 0,null)}.bind(this),a.on("error",w),l){var b;try{b=JSON.parse(localStorage[o])}catch(c){}b&&setTimeout(function(){this.configure(b.userAddress,b.href,b.storageApi,b.token)}.bind(this),0)}this._revisionCache={},this.connected&&setTimeout(this._emit.bind(this),0,"connected")},n.WireClient.REQUEST_TIMEOUT=3e4,n.WireClient.prototype={_request:function(a,b,d,g,i,l,m){if(("PUT"===a||"DELETE"===a)&&"/"===b[b.length-1])throw"Don't "+a+" on directories!";var o,p=promising(),q=this;return d!==RemoteStorage.Authorize.IMPLIED_FAKE_TOKEN&&(g.Authorization="Bearer "+d),this._emit("wire-busy",{method:a,isFolder:h(b)}),n.WireClient.request(a,b,{body:i,headers:g,responseType:"arraybuffer"},function(d,g){if(d)q._emit("wire-done",{method:a,isFolder:h(b),success:!1}),q.online=!1,p.reject(d);else if(q._emit("wire-done",{method:a,isFolder:h(b),success:!0}),q.online=!0,k(g.status))RemoteStorage.log("[WireClient] Error response status",g.status),o=l?c(g.getResponseHeader("ETag")):void 0,p.fulfill(g.status,void 0,void 0,o);else if(j(g.status)||200===g.status&&"GET"!==a)o=c(g.getResponseHeader("ETag")),RemoteStorage.log("[WireClient] Successful request",o),p.fulfill(g.status,void 0,void 0,o);else{var i=g.getResponseHeader("Content-Type");o=l?c(g.getResponseHeader("ETag")):200===g.status?m:void 0;var n=f(i);i&&"binary"!==n?e(g.response,n,function(a){RemoteStorage.log("[WireClient] Successful request",o),p.fulfill(g.status,a,i,o)}):(RemoteStorage.log("[WireClient] Successful request with unknown or binary mime-type",o),p.fulfill(g.status,g.response,i,o))}}),p},configure:function(a,b,c,d){"undefined"!=typeof a&&(this.userAddress=a),"undefined"!=typeof b&&(this.href=b),"undefined"!=typeof c&&(this.storageApi=c),"undefined"!=typeof d&&(this.token=d),"undefined"!=typeof this.storageApi&&(this._storageApi=u[this.storageApi]||t,this.supportsRevs=this._storageApi>=q),this.href&&this.token?(this.connected=!0,this.online=!0,this._emit("connected")):this.connected=!1,l&&(localStorage[o]=JSON.stringify({userAddress:this.userAddress,href:this.href,token:this.token,storageApi:this.storageApi})),n.WireClient.configureHooks.forEach(function(a){a.call(this)}.bind(this))},stopWaitingForToken:function(){this.connected||this._emit("not-connected")},get:function(a,c){if(!this.connected)throw new Error("not connected (path: "+a+")");c||(c={});var d={};if(this.supportsRevs)c.ifNoneMatch&&(d["If-None-Match"]=b(c.ifNoneMatch));else if(c.ifNoneMatch){this._revisionCache[a]}var e=this._request("GET",this.href+g(a),this.token,d,void 0,this.supportsRevs,this._revisionCache[a]);return h(a)?e.then(function(b,c,d,e){var f={};if("undefined"!=typeof c)try{c=JSON.parse(c)}catch(h){throw"Folder description at "+this.href+g(a)+" is not JSON"}if(200===b&&"object"==typeof c){if(0===Object.keys(c).length)b=404;else if(i(c)){for(var j in c.items)this._revisionCache[a+j]=c.items[j].ETag;f=c.items}else Object.keys(c).forEach(function(b){this._revisionCache[a+b]=c[b],f[b]={ETag:c[b]}}.bind(this));return promising().fulfill(b,f,d,e)}return promising().fulfill(b,c,d,e)}.bind(this)):e},put:function(a,c,d,e){if(!this.connected)throw new Error("not connected (path: "+a+")");e||(e={}),!d.match(/charset=/)&&(c instanceof ArrayBuffer||m(c))&&(d+="; charset=binary");var f={"Content-Type":d};return this.supportsRevs&&(e.ifMatch&&(f["If-Match"]=b(e.ifMatch)),e.ifNoneMatch&&(f["If-None-Match"]=b(e.ifNoneMatch))),this._request("PUT",this.href+g(a),this.token,f,c,this.supportsRevs)},"delete":function(a,c){if(!this.connected)throw new Error("not connected (path: "+a+")");c||(c={});var d={};return this.supportsRevs&&c.ifMatch&&(d["If-Match"]=b(c.ifMatch)),this._request("DELETE",this.href+g(a),this.token,d,void 0,this.supportsRevs)}},n.WireClient.cleanPath=g,n.WireClient.isArrayBufferView=m,n.WireClient.readBinaryData=d,n.WireClient.request=function(a,b,c,d){RemoteStorage.log("[WireClient]",a,b),d=d.bind(this);var e=!1,f=setTimeout(function(){e=!0,d("timeout")},n.WireClient.REQUEST_TIMEOUT),g=new XMLHttpRequest;if(g.open(a,b,!0),c.responseType&&(g.responseType=c.responseType),c.headers)for(var h in c.headers)g.setRequestHeader(h,c.headers[h]);g.onload=function(){e||(clearTimeout(f),d(null,g))},g.onerror=function(a){e||(clearTimeout(f),d(a))};var i=c.body;"object"==typeof i&&(m(i)||i instanceof ArrayBuffer&&(i=new Uint8Array(i))),g.send(i)},Object.defineProperty(RemoteStorage.WireClient.prototype,"storageType",{get:function(){if(this.storageApi){var a=this.storageApi.match(/draft-dejong-(remotestorage-\d\d)/);return a?a[1]:"2012.04"}}}),n.WireClient.configureHooks=[],n.WireClient._rs_init=function(a){l=a.localStorageAvailable(),a.remote=new n.WireClient(a),this.online=!0},n.WireClient._rs_supported=function(){return!!a.XMLHttpRequest},n.WireClient._rs_cleanup=function(a){l&&delete localStorage[o],a.removeEventListener("error",w)}}("undefined"!=typeof window?window:global),function(a){var b,c,d="remotestorage:discover",e={};RemoteStorage.Discover=function(a,b){function f(){var g=new XMLHttpRequest,h=j.shift();return h?(RemoteStorage.log("[Discover] Trying URL",h),g.open("GET",h,!0),g.onabort=g.onerror=function(){console.error("webfinger error",arguments,"(",h,")"),f()},g.onload=function(){if(200!==g.status)return f();var h;try{h=JSON.parse(g.responseText)}catch(i){return RemoteStorage.log("[Discover] Failed to parse profile ",g.responseText,i),void f()}if(!h.links)return RemoteStorage.log("[Discover] Profile has no links section ",JSON.stringify(h)),void f();var j;if(h.links.forEach(function(a){"remotestorage"===a.rel?j=a:"remoteStorage"!==a.rel||j||(j=a)}),RemoteStorage.log("[Discover] Got profile",h,"and link",j),j){var k=j.properties["http://tools.ietf.org/html/rfc6749#section-4.2"]||j.properties["auth-endpoint"],l=j.properties["http://remotestorage.io/spec/version"]||j.type;e[a]={href:j.href,type:l,authURL:k},c&&(localStorage[d]=JSON.stringify({cache:e})),b(j.href,l,k)}else f()},void g.send()):b()}if(a in e){var g=e[a];return void b(g.href,g.type,g.authURL)}var h=a.split("@")[1],i="?resource="+encodeURIComponent("acct:"+a),j=["https://"+h+"/.well-known/webfinger"+i,"http://"+h+"/.well-known/webfinger"+i];f()},RemoteStorage.Discover._rs_init=function(a){if(c=a.localStorageAvailable()){var b;try{b=JSON.parse(localStorage[d])}catch(f){}b&&(e=b.cache)}},RemoteStorage.Discover._rs_supported=function(){return b=!!a.XMLHttpRequest},RemoteStorage.Discover._rs_cleanup=function(){c&&delete localStorage[d]}}("undefined"!=typeof window?window:global),function(a){function b(){var a,b=RemoteStorage.Authorize.getLocation(),c=b.href.indexOf("#");if(-1!==c&&(a=b.href.substring(c+1),-1!==a.indexOf("=")))return a.split("&").reduce(function(a,b){var c=b.split("=");return a[decodeURIComponent(c[0])]=decodeURIComponent(c[1]),a},{})}RemoteStorage.ImpliedAuth=function(a,b){RemoteStorage.log("ImpliedAuth proceeding due to absent authURL; storageApi = "+a+" redirectUri = "+b),remoteStorage.remote.configure(void 0,void 0,void 0,RemoteStorage.Authorize.IMPLIED_FAKE_TOKEN),document.location=b},RemoteStorage.Authorize=function(a,b,c,d){RemoteStorage.log("[Authorize] authURL = ",a,"scope = ",b,"redirectUri = ",c,"clientId = ",d);var e=a,f=c.indexOf("#");e+=a.indexOf("?")>0?"&":"?",e+="redirect_uri="+encodeURIComponent(c.replace(/#.*$/,"")),e+="&scope="+encodeURIComponent(b),e+="&client_id="+encodeURIComponent(d),-1!==f&&(e+="&state="+encodeURIComponent(c.substring(f+1))),e+="&response_type=token",RemoteStorage.Authorize.setLocation(e)},RemoteStorage.Authorize.IMPLIED_FAKE_TOKEN=!1,RemoteStorage.prototype.authorize=function(a){this.access.setStorageType(this.remote.storageType);var b=this.access.scopeParameter,c=String(RemoteStorage.Authorize.getLocation()),d=c.match(/^(https?:\/\/[^\/]+)/)[0];RemoteStorage.Authorize(a,b,c,d)},RemoteStorage.Authorize.getLocation=function(){return a.document.location},RemoteStorage.Authorize.setLocation=function(b){if("string"==typeof b)a.document.location.href=b;else{if("object"!=typeof b)throw"Invalid location "+b;a.document.location=b}},RemoteStorage.prototype.impliedauth=function(){RemoteStorage.ImpliedAuth(this.remote.storageApi,String(document.location))},RemoteStorage.Authorize._rs_supported=function(){return"undefined"!=typeof document};var c;RemoteStorage.Authorize._rs_init=function(a){c=function(){var b=!1;if(e){if(e.error)throw"Authorization server errored: "+e.error;e.access_token&&(a.remote.configure(void 0,void 0,void 0,e.access_token),b=!0),e.remotestorage&&(a.connect(e.remotestorage),b=!0),e.state&&RemoteStorage.Authorize.setLocation("#"+e.state)}b||a.remote.stopWaitingForToken()};var d,e=b();e&&(d=RemoteStorage.Authorize.getLocation(),d.hash=""),a.on("features-loaded",c)},RemoteStorage.Authorize._rs_cleanup=function(a){a.removeEventListener("features-loaded",c)}}("undefined"!=typeof window?window:global),function(){RemoteStorage.Access=function(){this.reset()},RemoteStorage.Access.prototype={claim:function(a,b){if("string"!=typeof a||-1!==a.indexOf("/")||0===a.length)throw new Error("Scope should be a non-empty string without forward slashes");if(!b.match(/^rw?$/))throw new Error("Mode should be either 'r' or 'rw'");this._adjustRootPaths(a),this.scopeModeMap[a]=b},get:function(a){return this.scopeModeMap[a]},remove:function(a){var b,c={};for(b in this.scopeModeMap)c[b]=this.scopeModeMap[b];this.reset(),delete c[a];for(b in c)this.set(b,c[b])},checkPermission:function(a,b){var c=this.get(a);return c&&("r"===b||"rw"===c)},checkPathPermission:function(a,b){return this.checkPermission("*",b)?!0:!!this.checkPermission(this._getModuleName(a),b)},reset:function(){this.rootPaths=[],this.scopeModeMap={}},_getModuleName:function(a){if("/"!==a[0])throw new Error("Path should start with a slash");var b=a.replace(/^\/public/,"").match(/^\/([^\/]*)\//);return b?b[1]:"*"},_adjustRootPaths:function(a){"*"in this.scopeModeMap||"*"===a?this.rootPaths=["/"]:a in this.scopeModeMap||(this.rootPaths.push("/"+a+"/"),this.rootPaths.push("/public/"+a+"/"))},_scopeNameForParameter:function(a){if("*"===a.name&&this.storageType){if("2012.04"===this.storageType)return"";if(this.storageType.match(/remotestorage-0[01]/))return"root"}return a.name},setStorageType:function(a){this.storageType=a}},Object.defineProperty(RemoteStorage.Access.prototype,"scopes",{get:function(){return Object.keys(this.scopeModeMap).map(function(a){return{name:a,mode:this.scopeModeMap[a]}}.bind(this))}}),Object.defineProperty(RemoteStorage.Access.prototype,"scopeParameter",{get:function(){return this.scopes.map(function(a){return this._scopeNameForParameter(a)+":"+a.mode}.bind(this)).join(" ")}}),Object.defineProperty(RemoteStorage.prototype,"access",{get:function(){var a=new RemoteStorage.Access;
return Object.defineProperty(this,"access",{value:a}),a},configurable:!0}),RemoteStorage.Access._rs_init=function(){}}("undefined"!=typeof window?window:global),function(a){var b=a,c={},d=!1;RemoteStorage.Env=function(){return c},RemoteStorage.Env.isBrowser=function(){return"browser"===b},RemoteStorage.Env.isNode=function(){return"node"===b},RemoteStorage.Env.goBackground=function(){d=!0,RemoteStorage.Env._emit("background")},RemoteStorage.Env.goForeground=function(){d=!1,RemoteStorage.Env._emit("foreground")},RemoteStorage.Env._rs_init=function(){function a(){document[c.hiddenProperty]?RemoteStorage.Env.goBackground():RemoteStorage.Env.goForeground()}RemoteStorage.eventHandling(RemoteStorage.Env,"background","foreground"),"browser"===b&&("undefined"!=typeof document.hidden?(c.hiddenProperty="hidden",c.visibilityChangeEvent="visibilitychange"):"undefined"!=typeof document.mozHidden?(c.hiddenProperty="mozHidden",c.visibilityChangeEvent="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(c.hiddenProperty="msHidden",c.visibilityChangeEvent="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(c.hiddenProperty="webkitHidden",c.visibilityChangeEvent="webkitvisibilitychange"),document.addEventListener(c.visibilityChangeEvent,a,!1),a())},RemoteStorage.Env._rs_cleanup=function(){}}("undefined"!=typeof window?"browser":"node"),function(){"use strict";var a={view_info:'This app allows you to use your own storage. <a href="http://remotestorage.io/" target="_blank">Learn more!</a>',view_connect:"<strong>Connect</strong> remote storage",view_connecting:"Connecting <strong>%s</strong>",view_offline:"Offline",view_error_occured:"Sorry! An error occured.",view_invalid_key:"Wrong key!",view_confirm_reset:"Are you sure you want to reset everything? This will clear your local data and reload the page.",view_get_me_out:"Get me out of here!",view_error_plz_report:'If this problem persists, please <a href="http://remotestorage.io/community/" target="_blank">let us know</a>!',view_unauthorized:"Unauthorized! Click here to reconnect."};RemoteStorage.I18n={translate:function(){var b=arguments[0],c=Array.prototype.splice.call(arguments,1);if("string"!=typeof a[b])throw"Unknown translation string: "+b;return b=a[b],b.replace(/%s/g,function(){return c.shift()})},getDictionary:function(){return a},setDictionary:function(b){a=b}}}(),RemoteStorage.Assets={cipherIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHdpZHRoPSIyNS4xNzciIHZlcnNpb249IjEuMSIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxwYXRoIGQ9Im0yNS4xNzcgNS41MzIzYy0wLjA1NjQtMC4xMTI5MS0wLjA1NjQtMC4yMjU4MS0wLjE2OTM2LTAuMzM4NzEtMC4xMTI5LTAuMTEyOS0wLjI4MjI1LTAuMTY5MzYtMC4zOTUxNi0wLjE2OTM2aC0xMS40MDNjLTAuNzMzLTIuODc5LTMuMzg2NC01LjAyNDItNi40OTEzLTUuMDI0Mi0zLjY2OTMgMC02LjcxNzcgMy4wNDg0LTYuNzE3NyA2LjcxNzcgMCAzLjcyNjMgMy4wNDg0IDYuNzE3MyA2LjcxNzcgNi43MTczIDMuMzMwNyAwIDYuMDQwMy0yLjQyNzQgNi42MDQ4LTUuNTg4N2gyLjU0MDN2My42Njk0YzAgMC4yODIyNiAwLjI4MjI2IDAuNTA4MDYgMC41NjQ1MiAwLjUwODA2aDEuNzVjMC4yODIyNiAwIDAuNTY0NTItMC4yMjU4IDAuNTY0NTItMC41MDgwNnYtMy42Njk0aDEuNDY3N3Y1LjY0NTJjMCAwLjI4MjI1IDAuMjI1OCAwLjUwODA2IDAuNTA4MDYgMC41MDgwNmgxLjgwNjRjMC4yODIyNiAwIDAuNTA4MDctMC4yMjU4MSAwLjU2NDUyLTAuNTA4MDZ2LTUuNjQ1MmgxLjUyNDJjMC4xMTI5MSAwIDAuMjgyMjYgMCAwLjM5NTE2LTAuMTEyOSAwLjExMjkxLTAuMTEyOSAwLjE2OTM2LTAuMjgyMjYgMC4xNjkzNi0wLjM5NTE2di0xLjgwNjR6bS0xOC40NTkgNS4wODA3Yy0yLjA4ODcgMC0zLjgzODctMS42OTM2LTMuODM4Ny0zLjgzODcgMC0yLjE0NTIgMS43NS0zLjgzODcgMy44Mzg3LTMuODM4NyAyLjE0NTIgMCAzLjgzODcgMS42OTM2IDMuODM4NyAzLjgzODcgMCAyLjE0NTItMS42OTM2IDMuODM4Ny0zLjgzODcgMy44Mzg3eiIgZmlsbD0iI2ZmZiIvPgo8L3N2Zz4K",connectIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtMTAzNi40KSI+CiAgPHBhdGggZD0ibTEgMTA0Ny40di02aDd2LTRsNyA3LTcgN3YtNHoiIGZpbGw9IiNmZmYiLz4KIDwvZz4KPC9zdmc+Cg==",disconnectIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgdmVyc2lvbj0iMS4wIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxwYXRoIHN0eWxlPSJibG9jay1wcm9ncmVzc2lvbjp0Yjt0ZXh0LWluZGVudDowO2NvbG9yOiMwMDAwMDA7dGV4dC10cmFuc2Zvcm06bm9uZSIgZD0ibTguMDAwMSAwYy0wLjQ3MTQgMC0wLjk2MTAzIDAuNTQxOS0wLjk1IDF2NmMtMC4wMDc0NyAwLjUyODMxIDAuNDIxNjMgMSAwLjk1IDFzMC45NTc0Ny0wLjQ3MTY5IDAuOTUtMXYtNmMwLjAxNDYyMi0wLjYwNTEtMC40Nzg2LTEtMC45NS0xem0tMy4zNDM4IDIuNWMtMC4wODcxODYgMC4wMTkyOTQtMC4xNzE2MyAwLjA1MDk1OS0wLjI1IDAuMDkzNzUtMi45OTk1IDEuNTcxNS0zLjkxODQgNC43OTc5LTMuMTI1IDcuNDY4OCAwLjc5MzQgMi42NyAzLjI3OTkgNC45MzcgNi42ODc1IDQuOTM3IDMuMzU5MiAwIDUuODc3Mi0yLjE0OSA2LjcxOTItNC43ODEgMC44NDEtMi42MzIxLTAuMDU4LTUuODIzNC0zLjEyNS03LjU5NC0wLjQzNC0wLjI1MzYtMS4wNTktMC4wODk5LTEuMzEzIDAuMzQzNy0wLjI1MzYgMC40MzM2LTAuMDkgMS4wNTg5IDAuMzQ0IDEuMzEyNSAyLjM5MDggMS4zNzk4IDIuODgyNSAzLjQ5NDQgMi4yODEyIDUuMzc1LTAuNjAxMiAxLjg4MDYtMi4zNDQgMy40Mzc1LTQuOTA2MiAzLjQzNzUtMi41NzU5IDAtNC4yOTc2LTEuNjUwMi00Ljg3NS0zLjU5MzgtMC41Nzc2LTEuOTQzNS0wLjA0Ny00LjA0OCAyLjE4NzMtNS4yMTg3IDAuMzc4Ny0wLjIwNjMgMC41NzkxLTAuNjkyNSAwLjQ1NTgtMS4xMDU3LTAuMTIzMi0wLjQxMzMtMC41NTcyLTAuNzEwMy0wLjk4Ny0wLjY3NTUtMC4wMzEzLTAuMDAxNS0wLjA2MjYtMC4wMDE1LTAuMDkzOCAweiIgZmlsbD0iI2ZmZiIvPgo8L3N2Zz4K",dropbox:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QgPEBAhEOpfuQAABhZJREFUWMPVl31snVUdxz+/5/2577e3b7QbHaOD0nXshW4ZZkpGQmJYZkJUDAaZzCBGAxGd+pdZQsJIjCaKgFu09GWybIggm8yhMCsY92rcOkPHunbdtKOUbX36svX23uc+xz+eDsrWlztiNJzk5D7JPS+fc8739/2dA5+EsqJtyK18ZlCKbX9Lk6fd1uo5xbTVZmtwa4v35Np5Mry4TLYXCzAnyhsry2SwrmnokdnaTruq6i3e0lXl0tqQlkURCxwdDp9Th5p3+p9iS8afqk/VZq9kaZoDN8apdU3B1KFnmLde7AkezH0n3V0UQOJpz2hIsqEhLU+WOeAagmtCxISYBe1nVf4vfWrByYdSpyf3W9ziLapy6JgbAduAiBn2S1rCQBYODAQP7H01/zxby4JpAW5s8mproxypiRKNGIJrQNT8EMA1wTGEU8MBP/q7umPw0dSbAA3N3n3zI2yLG2oScPgbNYWICY4Be86o/le6g0W576bPXQWwcqvXdJ2t1idMsA1hJoCoCRfGYdOhwsa4TUWFrr7pGmDrzAiQCHfD//Xxwk/33Z/6HoA0tnhLXZ3XMoYqsy4PYs4M4Ohg6pB2ddqO+vR6BWL27AARXbBNiBjwh9Oqs+O8ukcT4eaopjLqGsJSCdSX29SX23x/lctXlzgE1zBAANxWIQuGxlWNACxr8WozJp0lljKsGXbA0qGu1GRBxsTUQRAGLgboIuQVvHI8S+f7eeK2TLsDSQd296rhPaeDm09+PdX/gQYqN3uZ+jh7ro+oRusKDdgmVEY1GqstSiOhdegCmoQAIoImIWTPYIHdXVlyBYhaVwLA70+rPz7fllvLi2W5KcPw9q3eS/VJ7kmYgm1A3BIWV5osq7IIlMLUQJOrAXQBXQtr1BR2d2XpOu8TtULR+gq2nQh+vv8rqUdnNaKGZm/9qnJpmp/U+fxCB5lYsaGFdTYAY9L3jmNj9F9S7OgKVh9/KNVelBVf8untv8TYSS8gbsrHyh8C2LqQtGE0z9CJYfVuUblgRZv3WGOJvJG0cF8/lWPNdo+O93xsHYoVuqkL/xzIs/HPHt2DPg0Zko+v0I8vbfHun9aKE5sH9YaobJsf5V4mRLXv33kSlmAYwspqgw23R7A1EJlahKYOSsHTB0cZHQ9IOBA3NSrjGo4hWAY82xH8rH1b/jF2laoPAOb80jPqYtKTMdRcTQNd+xAgbgmuJbiGELfh3lsc7q41KQSTABBcC1qPjLH/XzniNqScsP1kgMsm9nJ34e2mNcmFAMby1qFPZyz1WlxXrprhuEUgUPDbd8Y59n6edbe61KZ1TF14vSfPLw5dYjhXIOMIM6lGAV+u0+tv+ttI/2+6/LsMQVXpUFCAqJkS9MT5anB2NGDjWxf5Yp3DvjN5th/LUhETolaRTqigxMGIWVKtHVyX2tGTJd2X5agUIfi8CmvUFOKGT++gT8wqLlKUgnwATxwq7P32m35Z+32pPQZA54MpH1iSb/XWZmx2VthTD1AATCBlCZ+dpwNg6EJjlUH3hQIKRaCujhZFaOPtfUH+8HvBnQceSP11yjA8vC616+A5FevL8jt/YiCR0HiQcAUVrnDHHO0jHTUNllXrpC0NRXiefjAxM4rhHLzQpZqf+eFFd/LkM17JGlu9p+xC8IgPhGlaqE1rNJZrxOzQok0dnjviY+nhbSntCH3DAWN+QMIWEhYsqTD4wYHChrPfSP9kqnmM6QAMkYtz4xqmDqeGA+rLNObGZVozkglx1ZfqZAvC2ZGAz9RYlEbAlsLoNd+Kx5RqO5/njKXDsnKdhCXFOaFAZUzjznlhyt5xIjiSLbBz2oVO98fRdalOoGZ5m/dUQ4pvJZ3Zr/CXlS5A74gabzlYePztr6U2faxr+eRy/RYvtjgjHauvkxvi9oTDXaGBuAUJWyh1hb3vqsOvfiG5/L/yMAE483BqdNeuXO3LvcGX3vEUhsZVsaYL9IzACz3BXcVOXvQOfKRsupBZv8R4bnW19rmqGPzqHz4BcMGn5U/Hgod5oiT3P3kvVj7rrfnx/pHBu7d7Azc1eY3/l0drzWbPXNjsGXySy38AbtMqneWU7BkAAAAASUVORK5CYII=",googledrive:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QgPEA85ztzJcQAABZVJREFUWMPtl1uoXVcVhr8x5tprn7M1NG1i0pQqSG2jLcXipYJXjPogqFgpaHMSFUkpIjU+leKbDxIQSiHgjZgmrfXgQ6SKj5Ji7YVS05aUUqKQlNLQeDnN5Zzk9Jy99xy/D3OttU/StDlV33TBZM3FXmuMf/5jjv+fG/7XL1vti9tnv3Dtnnf+87JY8YmZNxEMM1sZ7tWpjz764mriVqvKvmfb1ONLy3+dGyWu6EWbvQwoydv5BMSqFuereakmfnls1GP25IDaBGYYjplhljDz5tk7YMtPfurAf6UE9Z6tNwDPAPXwtcxL1x9n4zRgDjjm1gCyC6JpCLoW/OX65of1nzCwG6gNo3aYeXF981mTvK2/WWFiMmoj7X+z5JcE0N87c4e7b3EvyTwZT5/r8ezZHu6GuWGpSegJ8/ZeBu6fHv35s1/7t0rQv29mjWF/ATZ1L4bQwohrpkYc/sBpwhJYAVdKYECzYAESIk4Am3sf+sPCW2LAzb9jbpvMDXfD3fEqkRIcGdbsevlt9LylPYG1K6/K3QzK75uAr78lBgb3b7sc2cl2Uaa21sDiGMvB2iQeu/EMm6bKHjD3SUsCEChnpEAKiLisd/PB+UsyMPjZNwzzh1ixcnOfsFCX51NU/PTvA6pkTUdYw4R3zyu1ArMDqyvBQB82+FiJUQJ4C8YgVT1SSvSTs+vEmkcwe7qEsUnt233Aij0BW4ZPbfngKpRQs7hXpYQNvRiuEtATWOW4bLi+z04pJbCnBAkBJggBQlIBIZCUJM0Cm9+QgcED2+/G7BprdMZaAFZExm1FWcz+NLdj32G/6XfPCB5GoJKp7H5FARHRtgRI1y0/+cm7Lwpg+v7t64DvNd5S2mqirKXHy6RoArp1Ykrc2hKtKCtXlNEyoQ6Ydi498fF1F2FAdwEbV9UnZne+8q19Z7o63vTb+TPnRneeWxwxHGdyziii6wApQNEydKUUd5wHYGrftvci7tKKLSME5bvCaruynI9rNL7vdZgiHhiP898Wl8bMnxty+uyIhcURo1FgjSg1DCDph4uPfuR9AFbvvS25p2cxbiyKVuh2o1O44n2lLLacb5v75v5fX6yl5h753IwUD+YcRAQ5B6FMMhj0jboSRhnAE258wvp7Z7aYcbCYCeCGt97ubfICLDP/q4WZ32x7M20fPfb+hxbH9ZdjHOQIIoR74EDywA3coa6MqtJnrP+LmRmcB63ob8dA1wllRm95LVc//22S16TGeKqqpqoHk10ESGJj/zjjgIhAISKCyJmcY6Uu8Pbq7C0V6ABh35dzvYWQG0QAhmSYCaUlNhzdCrlX2jpE6tV4b9DYcGFKEgG8svQucoicC4CsII8zeTxutAEQzx1duPL3vrxjdlnou0SDLdTulxJQmalXNzN98jpEJiSo+qTeoEnsnWC5lVZNRhkOZiq0G8XCmz1gpp3j/ZYdYLhj9qCkn3fJQ4QKeh9OccWxz6O0hGKM9wakeoBEZ1BmqfOMyYFk4gXS+edG4J4ju6/644VK+AOJhSIYpVRBpn/qPVRL65A51dRavJoG2UQkOqf0hgVrGG7u6syoJDObB+55nRANb589Afy40W0UwkY91h39CiLweg1UU+W3ohLNvC2VurJ1htR6A3QaYPCjI7uvOvGGOlfv2XoSuBzEhmNfZXDqBrweUPVqUlWodneSG+6J1NTevThfDpEjmnsmzuuCPPfCvRvfcakT0S2Aeq9tYPr0ZryeBvOOlZBKUIEiCAVZwTgy41x6v6hm0LFZ4o7N7IuXPA+EDx+XjQ+tP/4lUrW2vCI1ydR0iYgmWdtu4yzG7bOiAdn8iYlA0iFJh1Z1JJv+ye2b3n1419XRH2riP0aqqlKClABIjUMW+rtSlw5qmCpgsynnl56/d+M/+P91wfUvQjDgTzx9h9AAAAAASUVORK5CYII=",nocipherIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgogPHBhdGggZD0ibSAxMy4yMDMxMjQsMTEuNzczNDM4IGMgMC4yODEyNSwwLjI4MTI1IDAuNDIxODc1LDAuNjA5Mzc1IDAuNDIxODc1LDEuMDMxMjUgMCwwLjM3NSAtMC4xNDA2MjUsMC43NSAtMC40MjE4NzUsMS4wMzEyNSAtMC4yODEyNSwwLjIzNDM3NSAtMC42MDkzNzUsMC4zNzUgLTEuMDMxMjUsMC4zNzUgLTAuMzc1LDAgLTAuNzUsLTAuMTQwNjI1IC0xLjAzMTI1LC0wLjM3NSAwLDAgLTMuMTg3NDk4MSwtMy42NTYyNSAtMy4xODc0OTgxLC0zLjY1NjI1IDAsMCAtMy4xNDA2MjUsMy42NTYyNSAtMy4xNDA2MjUsMy42NTYyNSAtMC4yODEyNSwwLjIzNDM3NSAtMC42NTYyNSwwLjM3NSAtMS4wMzEyNSwwLjM3NSAtMC40MjE4NzUsMCAtMC43NSwtMC4xNDA2MjUgLTEuMDMxMjUsLTAuMzc1IC0wLjI4MTI1LC0wLjI4MTI1IC0wLjM3NSwtMC42NTYyNSAtMC4zNzUsLTEuMDMxMjUgMCwtMC40MjE4NzUgMC4wOTM3NSwtMC43NSAwLjM3NSwtMS4wMzEyNSAwLDAgMy4zMjgxMjUsLTMuNzUwMDAwNSAzLjMyODEyNSwtMy43NTAwMDA1IDAsMCAtMy4zMjgxMjUsLTMuNzk2ODc1IC0zLjMyODEyNSwtMy43OTY4NzUgLTAuMjgxMjUsLTAuMjgxMjUgLTAuMzc1LC0wLjYwOTM3NSAtMC4zNzUsLTEuMDMxMjUgMCwtMC4zNzUgMC4wOTM3NSwtMC43NSAwLjM3NSwtMS4wMzEyNSAwLjI4MTI1LC0wLjIzNDM3NSAwLjYwOTM3NSwtMC4zNzUgMS4wMzEyNSwtMC4zNzUgMC4zNzUsMCAwLjc1LDAuMTQwNjI1IDEuMDMxMjUsMC4zNzUgMCwwIDMuMTQwNjI1LDMuNjU2MjUgMy4xNDA2MjUsMy42NTYyNSAwLDAgMy4xODc0OTgxLC0zLjY1NjI1IDMuMTg3NDk4MSwtMy42NTYyNSAwLjI4MTI1LC0wLjIzNDM3NSAwLjY1NjI1LC0wLjM3NSAxLjAzMTI1LC0wLjM3NSAwLjQyMTg3NSwwIDAuNzUsMC4xNDA2MjUgMS4wMzEyNSwwLjM3NSAwLjI4MTI1LDAuMjgxMjUgMC40MjE4NzUsMC42NTYyNSAwLjQyMTg3NSwxLjAzMTI1IDAsMC40MjE4NzUgLTAuMTQwNjI1LDAuNzUgLTAuNDIxODc1LDEuMDMxMjUgMCwwIC0zLjMyODEyMzEsMy43OTY4NzUgLTMuMzI4MTIzMSwzLjc5Njg3NSAwLDAgMy4zMjgxMjMxLDMuNzUwMDAwNSAzLjMyODEyMzEsMy43NTAwMDA1IiBmaWxsPSIjZmZmIi8+Cjwvc3ZnPgo=",remoteStorageIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzIiIHdpZHRoPSIzMiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxkZWZzPgogIDxyYWRpYWxHcmFkaWVudCBpZD0iYSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGN5PSI1NzEuNDIiIGN4PSIxMDQ2LjUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoLjE0NDMzIDAgMCAuMTY2NjcgMTIwMS41IDg3Ny4xMSkiIHI9Ijk2Ij4KICAgPHN0b3Agc3RvcC1jb2xvcj0iI2ZmNGEwNCIgc3RvcC1vcGFjaXR5PSIuNzYxNTQiIG9mZnNldD0iMCIvPgogICA8c3RvcCBzdG9wLWNvbG9yPSIjZmY0YTA0IiBvZmZzZXQ9IjEiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogPC9kZWZzPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzMzYuNiAtOTU2LjM1KSI+CiAgPHBhdGggc3R5bGU9ImNvbG9yOiMwMDAwMDAiIGQ9Im0xMzUyLjYgOTU2LjM1IDAuMjg4NiAxNS4xMzYgMTMuNTY3LTcuMTM1Mi0xMy44NTUtOC4wMDExemwtMTMuODU1IDguMDAxMSAxMy41NjcgNy4xMzUyIDAuMjg4Ny0xNS4xMzZ6bS0xMy44NTUgOC4wMDExdjE1Ljk5OGwxMi45NTgtNy44MTYyLTEyLjk1OC04LjE4MTV6bTAgMTUuOTk4IDEzLjg1NSA4LjAwMTEtMC42MDg5LTE1LjMxNy0xMy4yNDYgNy4zMTU2em0xMy44NTUgOC4wMDExIDEzLjg1NS04LjAwMTEtMTMuMjUxLTcuMzE1Ni0wLjYwNDQgMTUuMzE3em0xMy44NTUtOC4wMDExdi0xNS45OThsLTEyLjk2MiA4LjE4MTUgMTIuOTYyIDcuODE2MnoiIGZpbGw9InVybCgjYSkiLz4KIDwvZz4KPC9zdmc+Cg==",remoteStorageIconCiphered:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzIiIHdpZHRoPSIzMiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxkZWZzPgogIDxyYWRpYWxHcmFkaWVudCBpZD0iYSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGN5PSI1NzEuNDIiIGN4PSIxMDQ2LjUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoLjE0NDMzIDAgMCAuMTY2NjcgMTIwMS41IDg3Ny4xMSkiIHI9Ijk2Ij4KICAgPHN0b3Agc3RvcC1jb2xvcj0iI2ZmNGEwNCIgc3RvcC1vcGFjaXR5PSIuNzYxNTQiIG9mZnNldD0iMCIvPgogICA8c3RvcCBzdG9wLWNvbG9yPSIjZmY0YTA0IiBvZmZzZXQ9IjEiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogPC9kZWZzPgogPHBhdGggc3R5bGU9ImNvbG9yOiMwMDAwMDAiIGQ9Im0xNiAwbDAuMTI1IDYuMzc1YzIuMDk4IDAuMDY3IDMuNzUgMS43NTk1IDMuNzUgMy44NzV2MS45NjloMS45MzcgMC4wMzJsOC00LjIxOS0xMy44NDQtOHpsLTEzLjg0NCA4IDggNC4yMTloMC4wMzIgMS45MDZ2LTEuOTY5YzAtMi4xMTU1IDEuNjgzLTMuODA4IDMuNzgxLTMuODc1bDAuMTI1LTYuMzc1em0tMTMuODQ0IDh2MTZsNy45OTk4LTQuODQ0di02LjA5NGwtNy45OTk4LTUuMDYyem0wIDE2bDEzLjg0NCA4LTAuMzc1LTEwLjA2MmgtNS40Njl2LTIuMzQ0bC03Ljk5OTggNC40MDZ6bTEzLjg0NCA4bDEzLjg0NC04LTgtNC40MDZ2Mi4zNDRoLTUuNDY5bC0wLjM3NSAxMC4wNjJ6bTEzLjg0NC04di0xNmwtOCA1LjA2MnY2LjA5NGw4IDQuODQ0em0tMTMuOTY5LTE3Yy0xLjczNSAwLjA2NjYtMy4xMjUgMS40OTg3LTMuMTI1IDMuMjV2MS45NjloMy4wMzFsMC4wOTQtNS4yMTl6bTAuMjUgMGwwLjA5NCA1LjIxOWgzLjAzMXYtMS45NjljMC0xLjc1MTMtMS4zOS0zLjE4MzQtMy4xMjUtMy4yNXptLTQuNzUgNS44NDRsNC4zNDQgMi4yODEgMC4wMzEtMi4yODFoLTQuMzc1em00Ljg3NSAwbDAuMDMxIDIuMjgxIDQuMzQ0LTIuMjgxaC00LjM3NXptLTUuNDM4IDAuNjI1djUuMzEybDQuMjgyLTIuNTkzLTQuMjgyLTIuNzE5em0xMC4zNzYgMGwtNC4yODIgMi43MTkgNC4yODIgMi41OTN2LTUuMzEyem0tNS43ODIgMy4yMTlsLTQuNTk0IDIuNTMxdjIuMDYyaDQuNzgybC0wLjE4OC00LjU5M3ptMS4xODggMGwtMC4xODggNC41OTNoNC43ODJ2LTIuMDYybC00LjU5NC0yLjUzMXoiIGZpbGw9InVybCgjYSkiLz4KPC9zdmc+Cg==",remoteStorageIconError:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzIiIHdpZHRoPSIzMiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxkZWZzPgogIDxyYWRpYWxHcmFkaWVudCBpZD0iYSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGN5PSI1NzEuNDIiIGN4PSIxMDQ2LjUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoLjE0NDMzIDAgMCAuMTY2NjcgMTIwMS41IDg3Ny4xMSkiIHI9Ijk2Ij4KICAgPHN0b3Agc3RvcC1jb2xvcj0iI2U5MDAwMCIgc3RvcC1vcGFjaXR5PSIuNzYwNzgiIG9mZnNldD0iMCIvPgogICA8c3RvcCBzdG9wLWNvbG9yPSIjZTkwMDAwIiBvZmZzZXQ9IjEiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogPC9kZWZzPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzMzYuNiAtOTU2LjM1KSI+CiAgPHBhdGggc3R5bGU9ImNvbG9yOiMwMDAwMDAiIGQ9Im0xMzUyLjYgOTU2LjM1IDAuMjg4NiAxNS4xMzYgMTMuNTY3LTcuMTM1Mi0xMy44NTUtOC4wMDExemwtMTMuODU1IDguMDAxMSAxMy41NjcgNy4xMzUyIDAuMjg4Ny0xNS4xMzZ6bS0xMy44NTUgOC4wMDExdjE1Ljk5OGwxMi45NTgtNy44MTYyLTEyLjk1OC04LjE4MTV6bTAgMTUuOTk4IDEzLjg1NSA4LjAwMTEtMC42MDg5LTE1LjMxNy0xMy4yNDYgNy4zMTU2em0xMy44NTUgOC4wMDExIDEzLjg1NS04LjAwMTEtMTMuMjUxLTcuMzE1Ni0wLjYwNDQgMTUuMzE3em0xMy44NTUtOC4wMDExdi0xNS45OThsLTEyLjk2MiA4LjE4MTUgMTIuOTYyIDcuODE2MnoiIGZpbGw9InVybCgjYSkiLz4KIDwvZz4KPC9zdmc+Cg==",remoteStorageIconOffline:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzIiIHdpZHRoPSIzMiIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KIDxkZWZzPgogIDxyYWRpYWxHcmFkaWVudCBpZD0iYSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGN5PSI1NzEuNDIiIGN4PSIxMDQ2LjUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoLjE0NDMzIDAgMCAuMTY2NjcgMTIwMS41IDg3Ny4xMSkiIHI9Ijk2Ij4KICAgPHN0b3Agc3RvcC1jb2xvcj0iIzY5Njk2OSIgc3RvcC1vcGFjaXR5PSIuNzYxNTQiIG9mZnNldD0iMCIvPgogICA8c3RvcCBzdG9wLWNvbG9yPSIjNjc2NzY3IiBvZmZzZXQ9IjEiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogPC9kZWZzPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzMzYuNiAtOTU2LjM1KSI+CiAgPHBhdGggc3R5bGU9ImNvbG9yOiMwMDAwMDAiIGQ9Im0xMzUyLjYgOTU2LjM1IDAuMjg4NiAxNS4xMzYgMTMuNTY3LTcuMTM1Mi0xMy44NTUtOC4wMDExemwtMTMuODU1IDguMDAxMSAxMy41NjcgNy4xMzUyIDAuMjg4Ny0xNS4xMzZ6bS0xMy44NTUgOC4wMDExdjE1Ljk5OGwxMi45NTgtNy44MTYyLTEyLjk1OC04LjE4MTV6bTAgMTUuOTk4IDEzLjg1NSA4LjAwMTEtMC42MDg5LTE1LjMxNy0xMy4yNDYgNy4zMTU2em0xMy44NTUgOC4wMDExIDEzLjg1NS04LjAwMTEtMTMuMjUxLTcuMzE1Ni0wLjYwNDQgMTUuMzE3em0xMy44NTUtOC4wMDExdi0xNS45OThsLTEyLjk2MiA4LjE4MTUgMTIuOTYyIDcuODE2MnoiIGZpbGw9InVybCgjYSkiLz4KIDwvZz4KPC9zdmc+Cg==",syncIcon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDg3LjUgMTAwIiB4bWw6c3BhY2U9InByZXNlcnZlIiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTUuOTk5OTk5IDE2IiB3aWR0aD0iMTYiIHZlcnNpb249IjEuMSIgeT0iMHB4IiB4PSIwcHgiIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01LjUxMTIgLTc2LjUyNSkiIGRpc3BsYXk9Im5vbmUiPgoJPHBhdGggZGlzcGxheT0iaW5saW5lIiBkPSJtNTEuNDczIDQyLjI1NS0yLjIwNSAyLjIxMmMxLjQ3OCAxLjQ3NyAyLjI5NSAzLjQ0MiAyLjI5NSA1LjUzMyAwIDQuMzA5LTMuNTA0IDcuODEyLTcuODEyIDcuODEydi0xLjU2MmwtMy4xMjUgMy4xMjUgMy4xMjQgMy4xMjV2LTEuNTYyYzYuMDI5IDAgMTAuOTM4LTQuOTA2IDEwLjkzOC0xMC45MzggMC0yLjkyNy0xLjE0MS01LjY3Ni0zLjIxNS03Ljc0NXoiLz4KCTxwYXRoIGRpc3BsYXk9ImlubGluZSIgZD0ibTQ2Ljg3NSA0MC42MjUtMy4xMjUtMy4xMjV2MS41NjJjLTYuMDMgMC0xMC45MzggNC45MDctMTAuOTM4IDEwLjkzOCAwIDIuOTI3IDEuMTQxIDUuNjc2IDMuMjE3IDcuNzQ1bDIuMjAzLTIuMjEyYy0xLjQ3Ny0xLjQ3OS0yLjI5NC0zLjQ0Mi0yLjI5NC01LjUzMyAwLTQuMzA5IDMuNTA0LTcuODEyIDcuODEyLTcuODEydjEuNTYybDMuMTI1LTMuMTI1eiIvPgo8L2c+CjxwYXRoIGZpbGw9IiNmZmYiIGQ9Im0xMCAwbC0wLjc1IDEuOTA2MmMtMS4wMDc4LTAuMjk0Mi0zLjQ1ODYtMC43NzA4LTUuNjU2MiAwLjkzNzYgMC0wLjAwMDItMy45MzAyIDIuNTk0MS0yLjA5MzggNy41OTQybDEuNjU2Mi0wLjcxOTJzLTEuNTM5OS0zLjExMjIgMS42ODc2LTUuNTMxM2MwIDAgMS42OTU3LTEuMTMzOSAzLjY4NzQtMC41OTM3bC0wLjcxODcgMS44MTI0IDMuODEyNS0xLjYyNS0xLjYyNS0zLjc4MTJ6Ii8+PHBhdGggZmlsbD0iI2ZmZiIgZD0ibTE0IDUuNTYyNWwtMS42NTYgMC43MTg3czEuNTQxIDMuMTEzNS0xLjY4OCA1LjUzMDhjMCAwLTEuNzI3MiAxLjEzNS0zLjcxODUgMC41OTRsMC43NS0xLjgxMi0zLjgxMjUgMS41OTQgMS41OTM4IDMuODEyIDAuNzgxMi0xLjkwNmMxLjAxMTMgMC4yOTUgMy40NjE1IDAuNzY2IDUuNjU2LTAuOTM4IDAgMCAzLjkyOC0yLjU5NCAyLjA5NC03LjU5MzV6Ii8+Cjwvc3ZnPgo=",widget:'<div class="rs-bubble rs-hidden">   <div class="rs-bubble-text remotestorage-initial remotestorage-error remotestorage-authing remotestorage-offline">     <span class="rs-status-text">{{view_connect}}</span>   </div>   <div class="rs-bubble-expandable">     <!-- error -->     <div class="remotestorage-error">       <pre class="rs-status-text rs-error-msg">{{ERROR_MSG}}</pre>       <button class="remotestorage-reset">{{view_get_me_out}}</button>       <p class="rs-centered-text rs-error-plz-report">{{view_error_plz_report}}</p>     </div>     <!-- connected -->     <div class="rs-bubble-text remotestorage-connected">       <strong class="userAddress">{{USER_ADDRESS}}</strong>       <p class="remotestorage-unauthorized">{{view_unauthorized}}</p>       <p class="remotestorage-invalid-key">{{view_invalid_key}}</p>       <form novalidate class="remotestorage-cipher-form">         <input placeholder="Secret key" name="userSecretKey" novalidate>         <button class="rs-cipher" name="rs-cipher" title="cipher" disabled="disabled">           <img>         </button>         <button class="rs-nocipher" name="rs-nocipher" title="no cipher">           <img>         </button>       </form>     </div>     <div class="rs-content remotestorage-connected">       <button class="rs-sync" title="sync"><img></button>       <button class="rs-disconnect" title="disconnect"><img></button>     </div>     <!-- initial -->     <form novalidate class="remotestorage-initial">       <input type="email" placeholder="user@provider.com" name="userAddress" novalidate>       <button class="connect" name="connect" title="connect" disabled="disabled">         <img>       </button>     </form>     <div class="rs-info-msg remotestorage-initial">{{view_info}}</div>   </div> </div> <img class="rs-dropbox rs-backends rs-action" alt="Connect to Dropbox"> <img class="rs-googledrive rs-backends rs-action" alt="Connect to Google Drive"> <img class="rs-cube rs-action"> ',widgetCss:'/** encoding:utf-8 **/ /* RESET */ #remotestorage-widget{text-align:left;}#remotestorage-widget input, #remotestorage-widget button{font-size:11px;}#remotestorage-widget form input[type=email]{margin-bottom:0;/* HTML5 Boilerplate */}#remotestorage-widget form input[type=submit]{margin-top:0;/* HTML5 Boilerplate */}/* /RESET */ #remotestorage-widget, #remotestorage-widget *{-moz-box-sizing:border-box;box-sizing:border-box;}#remotestorage-widget{position:absolute;right:10px;top:10px;font:normal 16px/100% sans-serif !important;user-select:none;-webkit-user-select:none;-moz-user-select:-moz-none;cursor:default;z-index:10000;}#remotestorage-widget .rs-bubble{background:rgba(80, 80, 80, .7);border-radius:5px 15px 5px 5px;color:white;font-size:0.8em;padding:5px;position:absolute;right:3px;top:9px;min-height:24px;white-space:nowrap;text-decoration:none;}.rs-bubble .rs-bubble-text{padding-right:32px;/* make sure the bubble doesn\'t "jump" when initially opening. */ min-width:182px;}#remotestorage-widget .rs-action{cursor:pointer;}/* less obtrusive cube when connected */ #remotestorage-widget.remotestorage-state-connected .rs-cube, #remotestorage-widget.remotestorage-state-busy .rs-cube{opacity:.3;-webkit-transition:opacity .3s ease;-moz-transition:opacity .3s ease;-ms-transition:opacity .3s ease;-o-transition:opacity .3s ease;transition:opacity .3s ease;}#remotestorage-widget.remotestorage-state-connected:hover .rs-cube, #remotestorage-widget.remotestorage-state-busy:hover .rs-cube, #remotestorage-widget.remotestorage-state-connected .rs-bubble:not(.rs-hidden) + .rs-cube{opacity:1 !important;}#remotestorage-widget .rs-backends{position:relative;top:5px;right:0;}#remotestorage-widget .rs-cube{position:relative;top:5px;right:0;}/* pulsing animation for cube when loading */ #remotestorage-widget .rs-cube.remotestorage-loading{-webkit-animation:remotestorage-loading .5s ease-in-out infinite alternate;-moz-animation:remotestorage-loading .5s ease-in-out infinite alternate;-o-animation:remotestorage-loading .5s ease-in-out infinite alternate;-ms-animation:remotestorage-loading .5s ease-in-out infinite alternate;animation:remotestorage-loading .5s ease-in-out infinite alternate;}@-webkit-keyframes remotestorage-loading{to{opacity:.7}}@-moz-keyframes remotestorage-loading{to{opacity:.7}}@-o-keyframes remotestorage-loading{to{opacity:.7}}@-ms-keyframes remotestorage-loading{to{opacity:.7}}@keyframes remotestorage-loading{to{opacity:.7}}#remotestorage-widget a{text-decoration:underline;color:inherit;}#remotestorage-widget form{margin-top:.7em;position:relative;}#remotestorage-widget form input{display:table-cell;vertical-align:top;border:none;border-radius:6px;font-weight:bold;color:white;outline:none;line-height:1.5em;height:2em;}#remotestorage-widget form input:disabled{color:#999;background:#444 !important;cursor:default !important;}#remotestorage-widget form input[type=email]:focus, #remotestorage-widget form input[type=password]:focus{background:#223;}#remotestorage-widget form input[type=email], #remotestorage-widget form input[type=password]{background:#000;width:100%;height:26px;padding:0 30px 0 5px;border-top:1px solid #111;border-bottom:1px solid #999;}#remotestorage-widget form input[type=email]:focus, #remotestorage-widget form input[type=password]:focus{background:#223;}#remotestorage-widget button:focus, #remotestorage-widget input:focus{box-shadow:0 0 4px #ccc;}#remotestorage-widget form input[type=email]::-webkit-input-placeholder, #remotestorage-widget form input[type=password]::-webkit-input-placeholder{color:#999;}#remotestorage-widget form input[type=email]:-moz-placeholder, #remotestorage-widget form input[type=password]:-moz-placeholder{color:#999;}#remotestorage-widget form input[type=email]::-moz-placeholder, #remotestorage-widget form input[type=password]::-moz-placeholder{color:#999;}#remotestorage-widget form input[type=email]:-ms-input-placeholder, #remotestorage-widget form input[type=password]:-ms-input-placeholder{color:#999;}#remotestorage-widget form input[type=submit]{background:#000;cursor:pointer;padding:0 5px;}#remotestorage-widget form input[type=submit]:hover{background:#333;}#remotestorage-widget .rs-info-msg{font-size:10px;color:#eee;margin-top:0.7em;white-space:normal;}#remotestorage-widget .rs-info-msg.last-synced-message{display:inline;white-space:nowrap;margin-bottom:.7em}#remotestorage-widget .rs-info-msg a:hover, #remotestorage-widget .rs-info-msg a:active{color:#fff;}#remotestorage-widget button img{vertical-align:baseline;}#remotestorage-widget button{border:none;border-radius:6px;font-weight:bold;color:white;outline:none;line-height:1.5em;height:26px;width:26px;background:#000;cursor:pointer;margin:0;padding:5px;}#remotestorage-widget button:hover{background:#333;}#remotestorage-widget .rs-bubble button.connect, #remotestorage-widget .rs-bubble button.rs-cipher, #remotestorage-widget .rs-bubble button.rs-nocipher{display:block;background:none;position:absolute;right:0;top:0;opacity:1;/* increase clickable area of connect, rs-cipher & rs-nocipher buttons */ margin:-5px;padding:10px;width:36px;height:36px;}#remotestorage-widget .rs-bubble button.rs-cipher{width:46px;}#remotestorage-widget .rs-bubble button.rs-nocipher{height:26px;margin:0;padding:4px 5px 5px;right:-32px;width:26px;}#remotestorage-widget .rs-bubble button.connect:not([disabled]):hover, #remotestorage-widget .rs-bubble button.rs-cipher:not([disabled]):hover, #remotestorage-widget .rs-bubble button.rs-nocipher:not([disabled]):hover{background:rgba(150,150,150,.5);}#remotestorage-widget .rs-bubble button.connect[disabled], #remotestorage-widget .rs-bubble button.rs-cipher[disabled]{opacity:.5;cursor:default !important;}#remotestorage-widget .rs-bubble button.rs-sync{position:relative;left:-5px;bottom:-5px;padding:4px 4px 0 4px;background:#555;}#remotestorage-widget .rs-bubble button.rs-sync:hover{background:#444;}#remotestorage-widget .rs-bubble button.rs-disconnect{background:#721;position:absolute;right:0;bottom:0;padding:4px 4px 0 4px;}#remotestorage-widget .rs-bubble button.rs-disconnect:hover{background:#921;}#remotestorage-widget .remotestorage-error-info{color:#f92;}#remotestorage-widget .remotestorage-reset{width:100%;background:#721;}#remotestorage-widget .remotestorage-reset:hover{background:#921;}#remotestorage-widget .rs-bubble .rs-content{margin-top:7px;}#remotestorage-widget pre{user-select:initial;-webkit-user-select:initial;-moz-user-select:text;max-width:27em;margin-top:1em;overflow:auto;}#remotestorage-widget .rs-centered-text{text-align:center;}#remotestorage-widget .rs-bubble.rs-hidden{padding-bottom:2px;border-radius:5px 15px 15px 5px;}#remotestorage-widget .rs-error-msg{min-height:5em;}.rs-bubble.rs-hidden .rs-bubble-expandable{display:none;}.remotestorage-state-connected .rs-bubble.rs-hidden{display:none;}.remotestorage-connected{display:none;}.remotestorage-state-connected .remotestorage-connected{display:block;}.remotestorage-cipher-form{display:none;}.remotestorage-cipher .remotestorage-cipher-form{display:block;}.remotestorage-invalid-key{display:none;}.remotestorage-invalid-key.remotestorage-cipher-error{display:block;}.remotestorage-initial{display:none;}.remotestorage-state-initial .remotestorage-initial{display:block;}.remotestorage-error{display:none;}.remotestorage-state-error .remotestorage-error{display:block;}.remotestorage-state-authing .remotestorage-authing{display:block;}.remotestorage-state-offline .remotestorage-connected, .remotestorage-state-offline .remotestorage-offline{display:block;}.remotestorage-unauthorized{display:none;}.remotestorage-state-unauthorized .rs-bubble.rs-hidden{display:none;}.remotestorage-state-unauthorized .remotestorage-connected, .remotestorage-state-unauthorized .remotestorage-unauthorized{display:block;}.remotestorage-state-unauthorized .rs-sync{display:none;}.remotestorage-state-busy .rs-bubble.rs-hidden{display:none;}.remotestorage-state-busy .rs-bubble{display:block;}.remotestorage-state-busy .remotestorage-connected{display:block;}.remotestorage-state-authing .rs-bubble-expandable{display:none;}'},function(){function a(a,b){return RemoteStorage.log("[Widget] Producing stateSetter for",b),function(){RemoteStorage.log("[Widget] Setting state",b,arguments),d&&(localStorage[e]=b),a.view?(a.rs.remote&&a.view.setUserAddress(a.rs.remote.userAddress),a.view.setState(b,arguments)):a._rememberedState=b}}function b(a){return function(b){b instanceof RemoteStorage.DiscoveryError?(console.error("Discovery failed",b,'"'+b.message+'"'),a.view.setState("initial",[b.message])):b instanceof RemoteStorage.SyncError?a.view.setState("offline",[]):b instanceof RemoteStorage.Unauthorized?a.view.setState("unauthorized"):(RemoteStorage.log("[Widget] Unknown error"),a.view.setState("error",[b]))}}function c(a){return"GET"===a.method&&a.isFolder?!1:!0}var d,e="remotestorage:widget:state",f={initial:!0,connected:!0,offline:!0};RemoteStorage.Widget=function(g){var h=this,i=0;if(this.rs=g,this.rs.remote.on("connected",a(this,"connected")),this.rs.on("disconnected",a(this,"initial")),this.rs.on("connecting",a(this,"authing")),this.rs.on("authing",a(this,"authing")),this.rs.on("error",b(this)),this.rs.remote&&(this.rs.remote.on("wire-busy",function(b){c(b)&&(i++,a(h,"busy")())}),this.rs.remote.on("wire-done",function(b){c(b)&&i--,0>=i&&b.success&&a(h,"connected")()})),d){var j=localStorage[e];j&&f[j]&&(this._rememberedState=j)}},RemoteStorage.Widget.prototype={display:function(a){return"string"==typeof a?a={domID:domID}:"undefined"==typeof a&&(a={}),this.view||this.setView(new RemoteStorage.Widget.View(this.rs)),this.view.display(a),this},linkWidgetToSync:function(){"object"==typeof this.rs.sync&&"function"==typeof this.rs.sync.sync?this.view.on("sync",this.rs.sync.sync.bind(this.rs.sync)):(RemoteStorage.log("[Widget] typeof this.rs.sync check fail",this.rs.sync),setTimeout(this.linkWidgetToSync.bind(this),1e3))
},setView:function(b){this.view=b,this.view.on("connect",function(a){"string"==typeof a?this.rs.connect(a):a.special&&this.rs[a.special].connect(a)}.bind(this)),this.view.on("secret-entered",function(b){this.view.setUserSecretKey(b),a(this,"ciphered")()}.bind(this)),this.view.on("secret-cancelled",function(){a(this,"notciphered")()}.bind(this)),this.view.on("disconnect",this.rs.disconnect.bind(this.rs)),this.linkWidgetToSync();try{this.view.on("reset",function(){var a=RemoteStorage.Authorize.getLocation();this.rs.on("disconnected",a.reload.bind(a)),this.rs.disconnect()}.bind(this))}catch(c){if(!c.message||!c.message.match(/Unknown event/))throw c}this._rememberedState&&(setTimeout(a(this,this._rememberedState),0),delete this._rememberedState)}},RemoteStorage.prototype.displayWidget=function(a){return this.widget.display(a)},RemoteStorage.Widget._rs_init=function(a){d=a.localStorageAvailable(),a.widget||(a.widget=new RemoteStorage.Widget(a))},RemoteStorage.Widget._rs_supported=function(){return"undefined"!=typeof document}}("undefined"!=typeof window?window:global),function(a){function b(a,b){return a.classList.remove(b)}function c(a,b){return a.classList.add(b)}function d(a){"function"==typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function e(a,b,c,d){var e=a.querySelector("."+b);if("undefined"!=typeof c){var f=e.querySelector("img");(f||e).src=RemoteStorage.Assets[c]}return e.addEventListener("click",d),e}function f(a){a.target.value?a.target.nextElementSibling.removeAttribute("disabled"):a.target.nextElementSibling.setAttribute("disabled","disabled")}var g=RemoteStorage.I18n.translate;RemoteStorage.Widget.View=function(a){if(this.rs=a,"undefined"==typeof document)throw"Widget not supported";RemoteStorage.eventHandling(this,"connect","secret-entered","secret-cancelled","disconnect","sync","display","reset");for(var b in this.events)this.events[b]=this.events[b].bind(this);this.hideBubbleOnBodyClick=function(a){for(var b=a.target;b!==document.body;b=b.parentElement)if("remotestorage-widget"===b.id)return;this.hideBubble()}.bind(this)},RemoteStorage.Widget.View.prototype={connectGdrive:function(){this._emit("connect",{special:"googledrive"})},connectDropbox:function(){this._emit("connect",{special:"dropbox"})},setState:function(a,b){RemoteStorage.log("[View] widget.view.setState(",a,",",b,");");var c=this.states[a];if("undefined"==typeof c)throw new Error("Bad State assigned to view: "+a);c.apply(this,b)},setUserAddress:function(a){this.userAddress=a||"";var b;this.div&&(b=this.div.querySelector("form.remotestorage-initial").userAddress)&&(b.value=this.userAddress)},setUserSecretKey:function(a){this.userSecretKey=a},toggleBubble:function(a){this.bubble.className.search("rs-hidden")<0?this.hideBubble(a):this.showBubble(a)},hideBubble:function(){c(this.bubble,"rs-hidden"),document.body.removeEventListener("click",this.hideBubbleOnBodyClick)},showBubble:function(a){b(this.bubble,"rs-hidden"),"undefined"!=typeof a&&d(a),document.body.addEventListener("click",this.hideBubbleOnBodyClick),this.div.querySelector(".remotestorage-connected").classList.contains("remotestorage-cipher")&&!this.userSecretKey?this.bubble.querySelector("form.remotestorage-cipher-form").userSecretKey.focus():this.bubble.querySelector("form.remotestorage-initial").userAddress.focus()},display:function(a){if("undefined"!=typeof this.div)return this.div;var b=document.createElement("div"),c=document.createElement("style");if(c.innerHTML=RemoteStorage.Assets.widgetCss,b.id="remotestorage-widget",b.innerHTML=RemoteStorage.Assets.widget,b.appendChild(c),a.domID){var d=document.getElementById(a.domID);if(!d)throw'Failed to find target DOM element with id="'+a.domID+'"';d.appendChild(b)}else document.body.appendChild(b);e(b,"rs-sync","syncIcon",this.events.sync),e(b,"rs-disconnect","disconnectIcon",this.events.disconnect),e(b,"remotestorage-reset",void 0,this.events.reset);e(b,"connect","connectIcon",this.events.connect);this.form=b.querySelector("form.remotestorage-initial");var g=this.form.userAddress;if(g.addEventListener("load",f),g.addEventListener("keyup",f),this.userAddress&&(g.value=this.userAddress),a.encryption){this.cipher=!0;var h=b.querySelector("form.remotestorage-cipher-form").userSecretKey;h.type="password";{e(b,"rs-cipher","cipherIcon",this.events["secret-entered"])}h.addEventListener("load",f),h.addEventListener("keyup",f),e(b,"rs-nocipher","nocipherIcon",this.events["secret-cancelled"])}this.cube=e(b,"rs-cube","remoteStorageIcon",this.toggleBubble.bind(this)),e(b,"rs-dropbox","dropbox",this.connectDropbox.bind(this)),e(b,"rs-googledrive","googledrive",this.connectGdrive.bind(this));var i={INPUT:!0,BUTTON:!0,IMG:!0},j=function(a){i[a.target.tagName]||this.div.classList.contains("remotestorage-state-unauthorized")||this.showBubble(a)}.bind(this);return this.bubble=e(b,"rs-bubble",void 0,j),this.hideBubble(),this.div=b,this.states.initial.call(this),this.events.display.call(this),this.div},states:{initial:function(a){var c=this.cube,d=a||g("view_info");c.src=RemoteStorage.Assets.remoteStorageIcon,this._renderTranslatedInitialContent(),a?(c.src=RemoteStorage.Assets.remoteStorageIconError,b(this.cube,"remotestorage-loading"),this.showBubble(),setTimeout(function(){c.src=RemoteStorage.Assets.remoteStorageIcon},2e3)):this.hideBubble(),this.div.className="remotestorage-state-initial",this.userSecretKey&&delete this.userSecretKey;var e=1;this._activateBackend("dropbox")&&(e+=1),this._activateBackend("googledrive")&&(e+=1),this.div.querySelector(".rs-bubble-text").style.paddingRight=32*e+8+"px";var f=this.div.querySelector(".connect");this.form.userAddress.value&&f.removeAttribute("disabled");var h=this.div.querySelector(".rs-info-msg");h.innerHTML=d,a?h.classList.add("remotestorage-error-info"):h.classList.remove("remotestorage-error-info")},authing:function(){this.div.removeEventListener("click",this.events.connect),this.div.className="remotestorage-state-authing",this.div.querySelector(".rs-status-text").innerHTML=g("view_connecting",this.userAddress),c(this.cube,"remotestorage-loading")},connected:function(){var a=this.cube;this.div.className="remotestorage-state-connected",this.div.querySelector(".userAddress").innerHTML=this.userAddress,a.src=RemoteStorage.Assets.remoteStorageIcon,b(a,"remotestorage-loading"),this.cipher&&(this.userSecretKey?this.userSecretKeyError?(a.src=RemoteStorage.Assets.remoteStorageIconError,c(this.div.querySelector(".remotestorage-connected"),"remotestorage-cipher"),c(this.div.querySelector(".remotestorage-invalid-key"),"remotestorage-cipher-error"),this.showBubble(),setTimeout(function(){a.src=RemoteStorage.Assets.remoteStorageIcon},5e3)):(b(this.div.querySelector(".remotestorage-invalid-key"),"remotestorage-cipher-error"),a.src=RemoteStorage.Assets.remoteStorageIconCiphered):(c(this.div.querySelector(".remotestorage-connected"),"remotestorage-cipher"),this.showBubble()));var d={googledrive:this.div.querySelector(".rs-googledrive"),dropbox:this.div.querySelector(".rs-dropbox")};d.googledrive.style.display=d.dropbox.style.display="none",d[this.rs.backend]?(d[this.rs.backend].style.display="inline-block",this.div.querySelector(".rs-bubble-text").style.paddingRight="72px"):this.div.querySelector(".rs-bubble-text").style.paddingRight="40px"},ciphered:function(){this.div.querySelector("form.remotestorage-cipher-form").userSecretKey.value="",b(this.div.querySelector(".remotestorage-invalid-key"),"remotestorage-cipher-error"),b(this.div.querySelector(".remotestorage-connected"),"remotestorage-cipher"),this.cube.src=RemoteStorage.Assets.remoteStorageIconCiphered,this.hideBubble()},notciphered:function(){this.cipher=!1,b(this.div.querySelector(".remotestorage-invalid-key"),"remotestorage-cipher-error"),b(this.div.querySelector(".remotestorage-connected"),"remotestorage-cipher"),this.hideBubble()},busy:function(){this.div.className="remotestorage-state-busy",c(this.cube,"remotestorage-loading")},offline:function(){this.div.className="remotestorage-state-offline",this.cube.src=RemoteStorage.Assets.remoteStorageIconOffline,this.div.querySelector(".rs-status-text").innerHTML=g("view_offline")},error:function(a){var b=a;this.div.className="remotestorage-state-error",this.div.querySelector(".rs-bubble-text").innerHTML="<strong>"+g("view_error_occured")+"</strong>",a instanceof Error&&(b=a.message+"\n\n"+a.stack),this.div.querySelector(".rs-error-msg").textContent=b,this.cube.src=RemoteStorage.Assets.remoteStorageIconError,this.showBubble()},unauthorized:function(){this.div.className="remotestorage-state-unauthorized",this.cube.src=RemoteStorage.Assets.remoteStorageIconError,this.showBubble(),this.div.addEventListener("click",this.events.connect)}},events:{connect:function(a){d(a),a.preventDefault(),this._emit("connect",this.div.querySelector("form.remotestorage-initial").userAddress.value)},"secret-entered":function(a){d(a),a.preventDefault(),this._emit("secret-entered",this.div.querySelector("form.remotestorage-cipher-form").userSecretKey.value)},"secret-cancelled":function(a){d(a),a.preventDefault(),this._emit("secret-cancelled")},sync:function(a){d(a),a.preventDefault(),this._emit("sync")},disconnect:function(a){d(a),a.preventDefault(),this._emit("disconnect")},reset:function(b){b.preventDefault();var c=a.confirm(g("view_confirm_reset"));c&&this._emit("reset")},display:function(a){a&&a.preventDefault(),this._emit("display")}},_renderTranslatedInitialContent:function(){this.div.querySelector(".rs-status-text").innerHTML=g("view_connect"),this.div.querySelector(".remotestorage-reset").innerHTML=g("view_get_me_out"),this.div.querySelector(".rs-error-plz-report").innerHTML=g("view_error_plz_report"),this.div.querySelector(".remotestorage-unauthorized").innerHTML=g("view_unauthorized"),this.div.querySelector(".remotestorage-invalid-key").innerHTML=g("view_invalid_key")},_activateBackend:function(a){var b="rs-"+a;return this.rs.apiKeys[a]?(this.div.querySelector("."+b).style.display="inline-block",!0):(this.div.querySelector("."+b).style.display="none",!1)}}}("undefined"!=typeof window?window:global),function(a){function b(a,c){if(a===c)return!0;if("object"==typeof a&&"object"==typeof c){if(Array.isArray(a)!=Array.isArray(c))return!1;if(Array.isArray(a)){if(a.length!=c.length)return!1;for(var d=0;d<a.length;d++)if(!b(a[d],c[d]))return!1}else{for(var e in a)if(void 0===c[e]&&void 0!==a[e])return!1;for(var e in c)if(void 0===a[e]&&void 0!==c[e])return!1;for(var e in a)if(!b(a[e],c[e]))return!1}return!0}return!1}function c(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function d(a,b){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return b=c(b||""),a=c(a||""),b&&a?(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority)+d(b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname)+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash:null}function e(a,b){if(void 0==b?b=a.id:"string"==typeof a.id&&(b=d(b,a.id),a.id=b),"object"==typeof a)if(Array.isArray(a))for(var c=0;c<a.length;c++)e(a[c],b);else if("string"==typeof a.$ref)a.$ref=d(b,a.$ref);else for(var f in a)"enum"!=f&&e(a[f],b)}function f(a,b,c,d,e){if(void 0==a)throw new Error("No code supplied for error: "+b);this.code=a,this.message=b,this.dataPath=c?c:"",this.schemaPath=d?d:"",this.subErrors=e?e:null}function g(a,b,c){if("string"==typeof b.id&&b.id.substring(0,c.length)==c){var d=b.id.substring(c.length);(c.length>0&&"/"==c.charAt(c.length-1)||"#"==d.charAt(0)||"?"==d.charAt(0))&&void 0==a[b.id]&&(a[b.id]=b)}if("object"==typeof b)for(var e in b)"enum"!=e&&"object"==typeof b[e]&&g(a,b[e],c);return a}var h=function(a,b){this.missing=[],this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError};h.prototype.returnError=function(a){return a},h.prototype.collectError=function(a){return a&&this.errors.push(a),null},h.prototype.prefixErrors=function(a,b,c){for(var d=a;d<this.errors.length;d++)this.errors[d]=this.errors[d].prefixWith(b,c);return this},h.prototype.getSchema=function(a){if(void 0!=this.schemas[a]){var b=this.schemas[a];return b}var c=a,d="";if(-1!=a.indexOf("#")&&(d=a.substring(a.indexOf("#")+1),c=a.substring(0,a.indexOf("#"))),void 0!=this.schemas[c]){var b=this.schemas[c],e=decodeURIComponent(d);if(""==e)return b;if("/"!=e.charAt(0))return void 0;for(var f=e.split("/").slice(1),g=0;g<f.length;g++){var h=f[g].replace("~1","/").replace("~0","~");if(void 0==b[h]){b=void 0;break}b=b[h]}if(void 0!=b)return b}void 0==this.missing[c]&&(this.missing.push(c),this.missing[c]=c)},h.prototype.addSchema=function(a,b){var c={};c[a]=b,e(b,a),g(c,b,a);for(var d in c)this.schemas[d]=c[d];return c},h.prototype.validateAll=function(a,b,c,d){if(void 0!=b.$ref&&(b=this.getSchema(b.$ref),!b))return null;var e=this.errors.length,f=this.validateBasic(a,b)||this.validateNumeric(a,b)||this.validateString(a,b)||this.validateArray(a,b)||this.validateObject(a,b)||this.validateCombinations(a,b)||null;if(f||e!=this.errors.length)for(;c&&c.length||d&&d.length;){var g=c&&c.length?""+c.pop():null,h=d&&d.length?""+d.pop():null;f&&(f=f.prefixWith(g,h)),this.prefixErrors(e,g,h)}return this.handleError(f)},h.prototype.validateBasic=function(a,b){var c;return(c=this.validateType(a,b))?c.prefixWith(null,"type"):(c=this.validateEnum(a,b))?c.prefixWith(null,"type"):null},h.prototype.validateType=function(a,b){if(void 0==b.type)return null;var c=typeof a;null==a?c="null":Array.isArray(a)&&(c="array");var d=b.type;"object"!=typeof d&&(d=[d]);for(var e=0;e<d.length;e++){var g=d[e];if(g==c||"integer"==g&&"number"==c&&a%1==0)return null}return new f(i.INVALID_TYPE,"invalid data type: "+c)},h.prototype.validateEnum=function(a,c){if(void 0==c["enum"])return null;for(var d=0;d<c["enum"].length;d++){var e=c["enum"][d];if(b(a,e))return null}return new f(i.ENUM_MISMATCH,"No enum match for: "+JSON.stringify(a))},h.prototype.validateNumeric=function(a,b){return this.validateMultipleOf(a,b)||this.validateMinMax(a,b)||null},h.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;return void 0==c?null:"number"==typeof a&&a%c!=0?new f(i.NUMBER_MULTIPLE_OF,"Value "+a+" is not a multiple of "+c):null},h.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!=b.minimum){if(a<b.minimum)return new f(i.NUMBER_MINIMUM,"Value "+a+" is less than minimum "+b.minimum).prefixWith(null,"minimum");if(b.exclusiveMinimum&&a==b.minimum)return new f(i.NUMBER_MINIMUM_EXCLUSIVE,"Value "+a+" is equal to exclusive minimum "+b.minimum).prefixWith(null,"exclusiveMinimum")}if(void 0!=b.maximum){if(a>b.maximum)return new f(i.NUMBER_MAXIMUM,"Value "+a+" is greater than maximum "+b.maximum).prefixWith(null,"maximum");if(b.exclusiveMaximum&&a==b.maximum)return new f(i.NUMBER_MAXIMUM_EXCLUSIVE,"Value "+a+" is equal to exclusive maximum "+b.maximum).prefixWith(null,"exclusiveMaximum")}return null},h.prototype.validateString=function(a,b){return this.validateStringLength(a,b)||this.validateStringPattern(a,b)||null},h.prototype.validateStringLength=function(a,b){return"string"!=typeof a?null:void 0!=b.minLength&&a.length<b.minLength?new f(i.STRING_LENGTH_SHORT,"String is too short ("+a.length+" chars), minimum "+b.minLength).prefixWith(null,"minLength"):void 0!=b.maxLength&&a.length>b.maxLength?new f(i.STRING_LENGTH_LONG,"String is too long ("+a.length+" chars), maximum "+b.maxLength).prefixWith(null,"maxLength"):null},h.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||void 0==b.pattern)return null;var c=new RegExp(b.pattern);return c.test(a)?null:new f(i.STRING_PATTERN,"String does not match pattern").prefixWith(null,"pattern")},h.prototype.validateArray=function(a,b){return Array.isArray(a)?this.validateArrayLength(a,b)||this.validateArrayUniqueItems(a,b)||this.validateArrayItems(a,b)||null:null},h.prototype.validateArrayLength=function(a,b){if(void 0!=b.minItems&&a.length<b.minItems){var c=new f(i.ARRAY_LENGTH_SHORT,"Array is too short ("+a.length+"), minimum "+b.minItems).prefixWith(null,"minItems");if(this.handleError(c))return c}if(void 0!=b.maxItems&&a.length>b.maxItems){var c=new f(i.ARRAY_LENGTH_LONG,"Array is too long ("+a.length+" chars), maximum "+b.maxItems).prefixWith(null,"maxItems");if(this.handleError(c))return c}return null},h.prototype.validateArrayUniqueItems=function(a,c){if(c.uniqueItems)for(var d=0;d<a.length;d++)for(var e=d+1;e<a.length;e++)if(b(a[d],a[e])){var g=new f(i.ARRAY_UNIQUE,"Array items are not unique (indices "+d+" and "+e+")").prefixWith(null,"uniqueItems");if(this.handleError(g))return g}return null},h.prototype.validateArrayItems=function(a,b){if(void 0==b.items)return null;var c;if(Array.isArray(b.items)){for(var d=0;d<a.length;d++)if(d<b.items.length){if(c=this.validateAll(a[d],b.items[d],[d],["items",d]))return c}else if(void 0!=b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(c=new f(i.ARRAY_ADDITIONAL_ITEMS,"Additional items not allowed").prefixWith(""+d,"additionalItems"),this.handleError(c)))return c}else if(c=this.validateAll(a[d],b.additionalItems,[d],["additionalItems"]))return c}else for(var d=0;d<a.length;d++)if(c=this.validateAll(a[d],b.items,[d],["items"]))return c;return null},h.prototype.validateObject=function(a,b){return"object"!=typeof a||null==a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b)||this.validateObjectRequiredProperties(a,b)||this.validateObjectProperties(a,b)||this.validateObjectDependencies(a,b)||null},h.prototype.validateObjectMinMaxProperties=function(a,b){var c=Object.keys(a);if(void 0!=b.minProperties&&c.length<b.minProperties){var d=new f(i.OBJECT_PROPERTIES_MINIMUM,"Too few properties defined ("+c.length+"), minimum "+b.minProperties).prefixWith(null,"minProperties");if(this.handleError(d))return d}if(void 0!=b.maxProperties&&c.length>b.maxProperties){var d=new f(i.OBJECT_PROPERTIES_MAXIMUM,"Too many properties defined ("+c.length+"), maximum "+b.maxProperties).prefixWith(null,"maxProperties");if(this.handleError(d))return d}return null},h.prototype.validateObjectRequiredProperties=function(a,b){if(void 0!=b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]){var e=new f(i.OBJECT_REQUIRED,"Missing required property: "+d).prefixWith(null,""+c).prefixWith(null,"required");if(this.handleError(e))return e}}return null},h.prototype.validateObjectProperties=function(a,b){var c;for(var d in a){var e=!1;if(void 0!=b.properties&&void 0!=b.properties[d]&&(e=!0,c=this.validateAll(a[d],b.properties[d],[d],["properties",d])))return c;if(void 0!=b.patternProperties)for(var g in b.patternProperties){var h=new RegExp(g);if(h.test(d)&&(e=!0,c=this.validateAll(a[d],b.patternProperties[g],[d],["patternProperties",g])))return c}if(!e&&void 0!=b.additionalProperties)if("boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(c=new f(i.OBJECT_ADDITIONAL_PROPERTIES,"Additional properties not allowed").prefixWith(d,"additionalProperties"),this.handleError(c)))return c}else if(c=this.validateAll(a[d],b.additionalProperties,[d],["additionalProperties"]))return c}return null},h.prototype.validateObjectDependencies=function(a,b){var c;if(void 0!=b.dependencies)for(var d in b.dependencies)if(void 0!==a[d]){var e=b.dependencies[d];if("string"==typeof e){if(void 0===a[e]&&(c=new f(i.OBJECT_DEPENDENCY_KEY,"Dependency failed - key must exist: "+e).prefixWith(null,d).prefixWith(null,"dependencies"),this.handleError(c)))return c}else if(Array.isArray(e))for(var g=0;g<e.length;g++){var h=e[g];if(void 0===a[h]&&(c=new f(i.OBJECT_DEPENDENCY_KEY,"Dependency failed - key must exist: "+h).prefixWith(null,""+g).prefixWith(null,d).prefixWith(null,"dependencies"),this.handleError(c)))return c}else if(c=this.validateAll(a,e,[],["dependencies",d]))return c}return null},h.prototype.validateCombinations=function(a,b){return this.validateAllOf(a,b)||this.validateAnyOf(a,b)||this.validateOneOf(a,b)||this.validateNot(a,b)||null},h.prototype.validateAllOf=function(a,b){if(void 0==b.allOf)return null;for(var c,d=0;d<b.allOf.length;d++){var e=b.allOf[d];if(c=this.validateAll(a,e,[],["allOf",d]))return c}return null},h.prototype.validateAnyOf=function(a,b){if(void 0==b.anyOf)return null;for(var c=[],d=this.errors.length,e=0;e<b.anyOf.length;e++){var g=b.anyOf[e],h=this.errors.length,j=this.validateAll(a,g,[],["anyOf",e]);if(null==j&&h==this.errors.length)return this.errors=this.errors.slice(0,d),null;j&&c.push(j.prefixWith(null,""+e).prefixWith(null,"anyOf"))}return c=c.concat(this.errors.slice(d)),this.errors=this.errors.slice(0,d),new f(i.ANY_OF_MISSING,'Data does not match any schemas from "anyOf"',"","/anyOf",c)},h.prototype.validateOneOf=function(a,b){if(void 0==b.oneOf)return null;for(var c=null,d=[],e=this.errors.length,g=0;g<b.oneOf.length;g++){var h=b.oneOf[g],j=this.errors.length,k=this.validateAll(a,h,[],["oneOf",g]);if(null==k&&j==this.errors.length){if(null!=c)return this.errors=this.errors.slice(0,e),new f(i.ONE_OF_MULTIPLE,'Data is valid against more than one schema from "oneOf": indices '+c+" and "+g,"","/oneOf");c=g}else k&&d.push(k.prefixWith(null,""+g).prefixWith(null,"oneOf"))}return null==c?(d=d.concat(this.errors.slice(e)),this.errors=this.errors.slice(0,e),new f(i.ONE_OF_MISSING,'Data does not match any schemas from "oneOf"',"","/oneOf",d)):(this.errors=this.errors.slice(0,e),null)},h.prototype.validateNot=function(a,b){if(void 0==b.not)return null;var c=this.errors.length,d=this.validateAll(a,b.not),e=this.errors.slice(c);return this.errors=this.errors.slice(0,c),null==d&&0==e.length?new f(i.NOT_PASSED,'Data matches schema from "not"',"","/not"):null};var i={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403};f.prototype={prefixWith:function(a,b){if(null!=a&&(a=a.replace("~","~0").replace("/","~1"),this.dataPath="/"+a+this.dataPath),null!=b&&(b=b.replace("~","~0").replace("/","~1"),this.schemaPath="/"+b+this.schemaPath),null!=this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this}};var j=new h,k={validate:function(a,b){var c=new h(j);"string"==typeof b&&(b={$ref:b});var d=(c.addSchema("",b),c.validateAll(a,b));return this.error=d,this.missing=c.missing,this.valid=null==d,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(a,b){var c=new h(j,!0);"string"==typeof b&&(b={$ref:b}),c.addSchema("",b),c.validateAll(a,b);var d={};return d.errors=c.errors,d.missing=c.missing,d.valid=0==d.errors.length,d},addSchema:function(a,b){return j.addSchema(a,b)},getSchema:function(a){return j.getSchema(a)},missing:[],error:null,normSchema:e,resolveUrl:d,errorCodes:i};a.tv4=k}("undefined"!=typeof window?window:global);var CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(a,b){var c,d=CHARS,e=[];if(b=b||d.length,a)for(c=0;a>c;c++)e[c]=d[0|Math.random()*b];else{var f;for(e[8]=e[13]=e[18]=e[23]="-",e[14]="4",c=0;36>c;c++)e[c]||(f=0|16*Math.random(),e[c]=d[19==c?3&f|8:f])}return e.join("")},function(){function a(a,b){console.log("WARNING: "+a+" is deprecated. Use "+b+" instead.")}var b=RemoteStorage;b.BaseClient=function(a,c){if("/"!==c[c.length-1])throw"Not a folder: "+c;"/"===c&&(this.makePath=function(a){return("/"===a[0]?"":"/")+a}),this.storage=a,this.base=c;var d=this.base.split("/");this.moduleName=d.length>2?d[1]:"root",b.eventHandling(this,"change"),this.on=this.on.bind(this),a.onChange(this.base,this._fireChange.bind(this))},b.BaseClient.prototype={extend:function(a){for(var b in a)this[b]=a[b];return this},scope:function(a){return new b.BaseClient(this.storage,this.makePath(a))},getListing:function(a,b){if("string"!=typeof a)a="";else if(a.length>0&&"/"!==a[a.length-1])throw"Not a folder: "+a;return this.storage.get(this.makePath(a),b).then(function(a,b){return 404===a?{}:b})},getAll:function(a,b){if("string"!=typeof a)a="";else if(a.length>0&&"/"!==a[a.length-1])throw"Not a folder: "+a;return this.storage.get(this.makePath(a),b).then(function(c,d){if(404===c)return{};if("object"==typeof d){var e=promising(),f=Object.keys(d).length,g=0;if(0===f)return{};for(var h in d)this.storage.get(this.makePath(a+h),b).then(function(a,b){if("string"==typeof b)try{b=JSON.parse(b)}catch(c){}"object"==typeof b&&(d[this.key]=b),g++,g===f&&e.fulfill(d)}.bind({key:h}));return e}}.bind(this))},getFile:function(a,b){return"string"!=typeof a?promising().reject("Argument 'path' of baseClient.getFile must be a string"):this.storage.get(this.makePath(a),b).then(function(a,b,c,d){return{data:b,mimeType:c,revision:d}})},storeFile:function(a,b,c){if("string"!=typeof a)return promising().reject("Argument 'mimeType' of baseClient.storeFile must be a string");if("string"!=typeof b)return promising().reject("Argument 'path' of baseClient.storeFile must be a string");if("string"!=typeof c&&"object"!=typeof c)return promising().reject("Argument 'body' of baseClient.storeFile must be a string, ArrayBuffer, or ArrayBufferView");this.storage.access.checkPathPermission(this.makePath(b),"rw")||console.warn("WARNING: Editing a document to which only read access ('r') was claimed");var d=this;return this.storage.put(this.makePath(b),c,a).then(function(a,c,e,f){if(200===a||201===a)return f;throw"Request (PUT "+d.makePath(b)+") failed with status: "+a})},getObject:function(a,b){return"string"!=typeof a?promising().reject("Argument 'path' of baseClient.getObject must be a string"):this.storage.get(this.makePath(a),b).then(function(b,c){if("object"==typeof c)return c;if("string"==typeof c)try{return JSON.parse(c)}catch(d){throw"Not valid JSON: "+this.makePath(a)}else if("undefined"!=typeof c&&200===b)throw"Not an object: "+this.makePath(a)})},storeObject:function(a,b,c){if("string"!=typeof a)return promising().reject("Argument 'typeAlias' of baseClient.storeObject must be a string");if("string"!=typeof b)return promising().reject("Argument 'path' of baseClient.storeObject must be a string");if("object"!=typeof c)return promising().reject("Argument 'object' of baseClient.storeObject must be an object");this._attachType(c,a);try{var d=this.validate(c);if(!d.valid)return promising(function(a){a.reject(d)})}catch(e){return promising().reject(e)}return this.storage.put(this.makePath(b),JSON.stringify(c),"application/json; charset=UTF-8").then(function(a,c,d,e){if(200===a||201===a)return e;throw"Request (PUT "+this.makePath(b)+") failed with status: "+a}.bind(this))},remove:function(a){return"string"!=typeof a?promising().reject("Argument 'path' of baseClient.remove must be a string"):(this.storage.access.checkPathPermission(this.makePath(a),"rw")||console.warn("WARNING: Removing a document to which only read access ('r') was claimed"),this.storage.delete(this.makePath(a)))},cache:function(b,c){if("string"!=typeof b)throw"Argument 'path' of baseClient.cache must be a string";if(c===!1?(a("caching strategy <false>",'<"FLUSH">'),c="FLUSH"):void 0===c?c="ALL":"string"!=typeof c&&(a("that caching strategy",'<"ALL">'),c="ALL"),"FLUSH"!==c&&"SEEN"!==c&&"ALL"!==c)throw'Argument \'strategy\' of baseclient.cache must be one of ["FLUSH", "SEEN", "ALL"]';return this.storage.caching.set(this.makePath(b),c),this},flush:function(a){return this.storage.local.flush(a)},makePath:function(a){return this.base+(a||"")},_fireChange:function(a){RemoteStorage.config.changeEvents[a.origin]&&(["new","old","lastCommon"].forEach(function(b){if((!a[b+"ContentType"]||/^application\/(.*)json(.*)/.exec(a[b+"ContentType"]))&&"string"==typeof a[b+"Value"])try{a[b+"Value"]=JSON.parse(a[b+"Value"])}catch(c){}}),this._emit("change",a))},_cleanPath:b.WireClient.cleanPath,getItemURL:function(a){if("string"!=typeof a)throw"Argument 'path' of baseClient.getItemURL must be a string";return this.storage.connected?(a=this._cleanPath(this.makePath(a)),this.storage.remote.href+a):void 0},uuid:function(){return Math.uuid()}},b.BaseClient._rs_init=function(){b.prototype.scope=function(a){if("string"!=typeof a)throw"Argument 'path' of baseClient.scope must be a string";if(!this.access.checkPathPermission(a,"r")){var c=a.replace(/(['\\])/g,"\\$1");console.warn("WARNING: please call remoteStorage.access.claim('"+c+"', 'r') (read only) or remoteStorage.access.claim('"+c+"', 'rw') (read/write) first")}return new b.BaseClient(this,a)}}}("undefined"!=typeof window?window:global),function(){RemoteStorage.BaseClient.Types={uris:{},schemas:{},aliases:{},declare:function(a,b,c,d){var e=a+"/"+b;if(d.extends){var f,g=d.extends.split("/");f=1===g.length?a+"/"+g.shift():g.join("/");var h=this.uris[f];if(!h)throw"Type '"+e+"' tries to extend unknown schema '"+f+"'";d.extends=this.schemas[h]}this.uris[e]=c,this.aliases[c]=e,this.schemas[c]=d},resolveAlias:function(a){return this.uris[a]},getSchema:function(a){return this.schemas[a]},inScope:function(a){var b=a.length,c={};for(var d in this.uris)if(d.substr(0,b+1)===a+"/"){var e=this.uris[d];c[e]=this.schemas[e]}return c}};var a=function(a){var b=new Error("Schema not found: "+a);return b.name="SchemaNotFound",b};a.prototype=Error.prototype,RemoteStorage.BaseClient.Types.SchemaNotFound=a,RemoteStorage.BaseClient.prototype.extend({declareType:function(a,b,c){c||(c=b,b=this._defaultTypeURI(a)),RemoteStorage.BaseClient.Types.declare(this.moduleName,a,b,c)},validate:function(b){var c=RemoteStorage.BaseClient.Types.getSchema(b["@context"]);if(c)return tv4.validateResult(b,c);throw new a(b["@context"])},_defaultTypeURI:function(a){return"http://remotestorage.io/spec/modules/"+encodeURIComponent(this.moduleName)+"/"+encodeURIComponent(a)},_attachType:function(a,b){a["@context"]=RemoteStorage.BaseClient.Types.resolveAlias(this.moduleName+"/"+b)||this._defaultTypeURI(b)}}),Object.defineProperty(RemoteStorage.BaseClient.prototype,"schemas",{configurable:!0,get:function(){return RemoteStorage.BaseClient.Types.inScope(this.moduleName)}})}("undefined"!=typeof window?window:global),function(){RemoteStorage.MODULES={},RemoteStorage.defineModule=function(a,b){if(RemoteStorage.MODULES[a]=b,Object.defineProperty(RemoteStorage.prototype,a,{configurable:!0,get:function(){var b=this._loadModule(a);return Object.defineProperty(this,a,{value:b}),b}}),-1!==a.indexOf("-")){var c=a.replace(/\-[a-z]/g,function(a){return a[1].toUpperCase()});Object.defineProperty(RemoteStorage.prototype,c,{get:function(){return this[a]}})}},RemoteStorage.prototype._loadModule=function(a){var b=RemoteStorage.MODULES[a];if(b){var c=b(new RemoteStorage.BaseClient(this,"/"+a+"/"),new RemoteStorage.BaseClient(this,"/public/"+a+"/"));return c.exports}throw"Unknown module: "+a},RemoteStorage.prototype.defineModule=function(){console.log("remoteStorage.defineModule is deprecated, use RemoteStorage.defineModule instead!"),RemoteStorage.defineModule.apply(RemoteStorage,arguments)}}(),function(){function a(a,b,c){function d(a,b,c,d){[b,c,d].forEach(function(b){var c=document.createElement("td");c.textContent=b||"",a.appendChild(c)})}function e(a){function c(b,c,f,g){if(200===b){var i=document.createElement("tr");
if(h.appendChild(i),d(i,a,f,g),"/"===a[a.length-1])for(var j in c)e(a+j)}}b.connected!==!1&&b.get(a).then(c)}a.setAttribute("border","1"),a.style.margin="8px",a.style.color="white",a.innerHTML="";var f=document.createElement("thead");a.appendChild(f);var g=document.createElement("tr");f.appendChild(g),["Path","Content-Type","Revision"].forEach(function(a){var b=document.createElement("th");b.textContent=a,f.appendChild(b)});var h=document.createElement("tbody");a.appendChild(h),c.forEach(e)}function b(b,c,d,e){var f=document.createElement("div"),g=document.createElement("h2");g.textContent=b,f.appendChild(g);var h=document.createElement("button");if(h.textContent="Refresh",h.onclick=function(){a(c,d,e)},f.appendChild(h),d.reset){var i=document.createElement("button");i.textContent="Reset",i.onclick=function(){d.reset(function(b){d=b,a(c,d,e)})},f.appendChild(i)}return f.appendChild(c),a(c,d,e),f}function c(a){function b(){f.innerHTML="",a.forAllNodes(function(a){if(a.local&&a.local.body){var b=document.createElement("li");b.textContent=JSON.stringify(a.local),f.appendChild(b)}})}var c=document.createElement("div"),d=document.createElement("h2");d.textContent="Outgoing changes",c.appendChild(d);var e=document.createElement("button");e.textContent="Refresh",c.appendChild(e);var f=document.createElement("ul");return f.style.fontFamily="courier",c.appendChild(f),e.onclick=b,b(),c}RemoteStorage.prototype.inspect=function(){var d=document.createElement("div");d.id="remotestorage-inspect",d.style.position="absolute",d.style.top=0,d.style.left=0,d.style.background="black",d.style.color="white",d.style.border="groove 5px #ccc";var e=document.createElement("div");e.style.position="absolute",e.style.top=0,e.style.left=0;var f=document.createElement("strong");f.textContent=" remotestorage.js inspector ",e.appendChild(f);var g;this.local&&(g=document.createElement("button"),g.textContent="Synchronize",e.appendChild(g));var h=document.createElement("button");h.textContent="Close",h.onclick=function(){document.body.removeChild(d)},e.appendChild(h),d.appendChild(e);var i=[];for(var j in this.caching._rootPaths)this.caching._rootPaths.hasOwnProperty(j)&&i.push(j);var k=document.createElement("table"),l=document.createElement("table");d.appendChild(b("Remote",k,this.remote,i)),this.local&&(d.appendChild(b("Local",l,this.local,["/"])),d.appendChild(c(this.local)),g.onclick=function(){this.log("sync clicked"),this.sync.sync().then(function(){this.log("SYNC FINISHED"),a(l,this.local,["/"])}.bind(this),function(a){console.error("SYNC FAILED",a,a.stack)})}.bind(this)),document.body.appendChild(d)}}(),function(){var a={getEventEmitter:function(){var a={},b=Array.prototype.slice.call(arguments);return b.unshift(a),RemoteStorage.eventHandling.apply(RemoteStorage,b),a.emit=a._emit,a},extend:function(a){var b=Array.prototype.slice.call(arguments,1);return b.forEach(function(b){for(var c in b)a[c]=b[c]}),a},asyncEach:function(a,b){return this.asyncMap(a,b).then(function(){return a})},asyncMap:function(a,b){function c(){f++,f===e&&d.fulfill(g,h)}var d=promising(),e=a.length,f=0,g=[],h=[];return a.forEach(function(a,d){var e;try{e=b(a)}catch(f){c(),h[d]=f}"object"==typeof e&&"function"==typeof e.then?e.then(function(a){g[d]=a,c()},function(a){h[d]=a,c()}):(c(),g[d]=e)}),d},containingFolder:function(a){var b=a.replace(/[^\/]+\/?$/,"");return b===a?null:b},isFolder:function(a){return"/"===a.substr(-1)},baseName:function(b){var c=b.split("/");return a.isFolder(b)?c[c.length-2]+"/":c[c.length-1]},bindAll:function(a){for(var b in this)"function"==typeof a[b]&&(a[b]=a[b].bind(a))}};Object.defineProperty(RemoteStorage.prototype,"util",{get:function(){return console.log("DEPRECATION WARNING: remoteStorage.util is deprecated and will be removed with the next major release."),a}})}(),function(){function a(a){return"/"===a.substr(-1)&&(a=a.substr(0,a.length-1)),decodeURIComponent(a)}function b(a){return a.replace(/[^\/]+\/?$/,"")}function c(a){var b=a.split("/");return"/"===a.substr(-1)?b[b.length-2]+"/":b[b.length-1]}var d=RemoteStorage,e="https://www.googleapis.com",f="https://accounts.google.com/o/oauth2/auth",g="https://www.googleapis.com/auth/drive",h="application/vnd.google-apps.folder",i="application/json; charset=UTF-8",j=function(a){this.maxAge=a,this._items={}};j.prototype={get:function(a){var b=this._items[a],c=(new Date).getTime();return b&&b.t>=c-this.maxAge?b.v:void 0},set:function(a,b){this._items[a]={v:b,t:(new Date).getTime()}}},d.GoogleDrive=function(a,b){d.eventHandling(this,"change","connected","wire-busy","wire-done","not-connected"),this.rs=a,this.clientId=b,this._fileIdCache=new j(300)},d.GoogleDrive.prototype={connected:!1,online:!0,configure:function(a,b,c,d){d?(localStorage["remotestorage:googledrive:token"]=d,this.token=d,this.connected=!0,this._emit("connected")):(this.connected=!1,delete this.token,delete localStorage["remotestorage:googledrive:token"])},connect:function(){this.rs.setBackend("googledrive"),d.Authorize(f,g,String(d.Authorize.getLocation()),this.clientId)},stopWaitingForToken:function(){this.connected||this._emit("not-connected")},get:function(a,b){return"/"===a.substr(-1)?this._getFolder(a,b):this._getFile(a,b)},put:function(a,b,c,d){function e(a,b){if(a)f.reject(a);else if(b.status>=200&&b.status<300){var c=JSON.parse(b.responseText),d=c.etag.substring(1,c.etag.length-1);f.fulfill(200,void 0,c.mimeType,d)}else 412===b.status?f.fulfill(412,void 0,void 0,"conflict"):f.reject("PUT failed with status "+b.status+" ("+b.responseText+")")}var f=promising();return this._getFileId(a,function(g,h){if(g)return void f.reject(g);if(h){if(d&&"*"===d.ifNoneMatch)return void e(void 0,{status:412});this._updateFile(h,a,b,c,d,e)}else this._createFile(a,b,c,d,e)}),f},"delete":function(a,b){var c=promising();return this._getFileId(a,function(a,d){return a?void c.reject(a):d?void this._getMeta(d,function(a,f){var g;return"object"==typeof f&&"string"==typeof f.etag&&(g=f.etag.substring(1,f.etag.length-1)),b&&b.ifMatch&&b.ifMatch!==g?void c.fulfill(412,void 0,void 0,g):a?void c.reject(a):void this._request("DELETE",e+"/drive/v2/files/"+d,{},function(a,b){a?c.reject(a):200===b.status||204===b.status?c.fulfill(200):c.reject("Delete failed: "+b.status+" ("+b.responseText+")")})}):void c.fulfill(200)}),c},_updateFile:function(a,b,c,d,f,g){g=g.bind(this);var h={mimeType:d},i={"Content-Type":"application/json; charset=UTF-8"};f&&f.ifMatch&&(i["If-Match"]='"'+f.ifMatch+'"'),this._request("PUT",e+"/upload/drive/v2/files/"+a+"?uploadType=resumable",{body:JSON.stringify(h),headers:i},function(a,b){412===b.status?g(void 0,b):a?g(a):this._request("PUT",b.getResponseHeader("Location"),{body:d.match(/^application\/json/)?JSON.stringify(c):c},g)})},_createFile:function(b,d,f,g,h){h=h.bind(this),this._getParentId(b,function(g,i){if(g)return void h(g);var j=c(b),k={title:a(j),mimeType:f,parents:[{kind:"drive#fileLink",id:i}]};this._request("POST",e+"/upload/drive/v2/files?uploadType=resumable",{body:JSON.stringify(k),headers:{"Content-Type":"application/json; charset=UTF-8"}},function(a,b){a?h(a):this._request("POST",b.getResponseHeader("Location"),{body:f.match(/^application\/json/)?JSON.stringify(d):d},h)})})},_getFile:function(a,b){var c=promising();return this._getFileId(a,function(a,d){a?c.reject(a):this._getMeta(d,function(a,d){var e;if("object"==typeof d&&"string"==typeof d.etag&&(e=d.etag.substring(1,d.etag.length-1)),a)c.reject(a);else{if(b&&b.ifNoneMatch&&e==b.ifNoneMatch)return void c.fulfill(304);var f={};if(!d.downloadUrl){if(!d.exportLinks||!d.exportLinks["text/html"])return void c.fulfill(200,"",d.mimeType,e);d.mimeType+=";export=text/html",d.downloadUrl=d.exportLinks["text/html"]}d.mimeType.match(/charset=binary/)&&(f.responseType="blob"),this._request("GET",d.downloadUrl,f,function(a,b){if(a)c.reject(a);else{var f=b.response;if(d.mimeType.match(/^application\/json/))try{f=JSON.parse(f)}catch(g){}c.fulfill(200,f,d.mimeType,e)}})}})}),c},_getFolder:function(a){var b=promising();return this._getFileId(a,function(c,d){var f,g,j,k,l,m;c?b.reject(c):d?(f="'"+d+"' in parents",g="items(downloadUrl,etag,fileSize,id,mimeType,title)",this._request("GET",e+"/drive/v2/files?q="+encodeURIComponent(f)+"&fields="+encodeURIComponent(g)+"&maxResults=1000",{},function(c,d){if(c)b.reject(c);else if(200===d.status){try{j=JSON.parse(d.responseText)}catch(e){return void b.reject("non-JSON response from GoogleDrive")}for(m={},k=0;k<j.items.length;k++)l=j.items[k].etag.substring(1,j.items[k].etag.length-1),j.items[k].mimeType===h?(this._fileIdCache.set(a+j.items[k].title+"/",j.items[k].id),m[j.items[k].title+"/"]={ETag:l}):(this._fileIdCache.set(a+j.items[k].title,j.items[k].id),m[j.items[k].title]={ETag:l,"Content-Type":j.items[k].mimeType,"Content-Length":j.items[k].fileSize});b.fulfill(200,m,i,void 0)}else b.reject("request failed or something: "+d.status)})):b.fulfill(404)}),b},_getParentId:function(a,c){c=c.bind(this);var d=b(a);this._getFileId(d,function(a,b){a?c(a):b?c(null,b):this._createFolder(d,c)})},_createFolder:function(b,d){d=d.bind(this),this._getParentId(b,function(f,g){f?d(f):this._request("POST",e+"/drive/v2/files",{body:JSON.stringify({title:a(c(b)),mimeType:h,parents:[{id:g}]}),headers:{"Content-Type":"application/json; charset=UTF-8"}},function(a,b){if(a)d(a);else{var c=JSON.parse(b.responseText);d(null,c.id)}})})},_getFileId:function(a,c){c=c.bind(this);var d;"/"===a?c(null,"root"):(d=this._fileIdCache.get(a))?c(null,d):this._getFolder(b(a)).then(function(){var b=this._fileIdCache.get(a);return b?void c(null,b):void("/"===a.substr(-1)?this._createFolder(a,function(){this._getFileId(a,c)}.bind(this)):c(null,null))}.bind(this),c)},_getMeta:function(a,b){b=b.bind(this),this._request("GET",e+"/drive/v2/files/"+a,{},function(c,d){c?b(c):200===d.status?b(null,JSON.parse(d.responseText)):b("request (getting metadata for "+a+") failed with status: "+d.status)})},_request:function(a,b,c,e){e=e.bind(this),c.headers||(c.headers={}),c.headers.Authorization="Bearer "+this.token,d.WireClient.request.call(this,a,b,c,function(a,b){return b&&401===b.status?void this.connect():void e(a,b)})}},d.GoogleDrive._rs_init=function(a){var b=a.apiKeys.googledrive;b&&(a.googledrive=new d.GoogleDrive(a,b.client_id),"googledrive"===a.backend&&(a._origRemote=a.remote,a.remote=a.googledrive))},d.GoogleDrive._rs_supported=function(){return!0},d.GoogleDrive._rs_cleanup=function(a){a.setBackend(void 0),a._origRemote&&(a.remote=a._origRemote,delete a._origRemote)}}(this),function(a){function b(a){this.defaultValue=a,this._storage={},this.set=this.justSet,this.delete=this.justDelete}function c(a){a._dropboxOrigSync||(a._dropboxOrigSync=a.sync.bind(a),a.sync=function(){return this.dropbox.fetchDelta.apply(this.dropbox,arguments).then(a._dropboxOrigSync,function(b){a._emit("error",new a.SyncError(b))})})}function d(a){a._dropboxOrigSync&&(a.sync=a._dropboxOrigSync,delete a._dropboxOrigSync)}function e(a){a._origBaseClientGetItemURL||(a._origBaseClientGetItemURL=l.BaseClient.prototype.getItemURL,l.BaseClient.prototype.getItemURL=function(b){var c=a.dropbox._itemRefs[b];return c?c:""})}function f(a){a._origBaseClieNtGetItemURL&&(l.BaseClient.prototype.getItemURL=a._origBaseClietGetItemURL,delete a._origBaseClietGetItemURL)}function g(a){a._origRemote||(a._origRemote=a.remote,a.remote=a.dropbox)}function h(a){a._origRemote&&(a.remote=a._origRemote,delete a._origRemote)}function i(a){g(a),a.sync&&c(a),e(a)}function j(a){h(a),d(a),f(a)}var k,l=RemoteStorage,m="https://www.dropbox.com/1/oauth2/authorize",n="remotestorage:dropbox",o=l.WireClient.cleanPath;b.prototype={get:function(a){a=a.toLowerCase();var b=this._storage[a];return"undefined"==typeof b&&(b=this.defaultValue,this._storage[a]=b),b},propagateSet:function(a,b){return a=a.toLowerCase(),this._storage[a]===b?b:(this._propagate(a,b),this._storage[a]=b)},propagateDelete:function(a){return a=a.toLowerCase(),this._propagate(a,this._storage[a]),delete this._storage[a]},_activatePropagation:function(){return this.set=this.propagateSet,this.delete=this.propagateDelete,!0},justSet:function(a,b){return a=a.toLowerCase(),this._storage[a]=b},justDelete:function(a){return a=a.toLowerCase(),delete this._storage[a]},_propagate:function(a,b){for(var c=a.split("/").slice(0,-1),d=c.length,e="",f=0;d>f;f++)e+=c[f]+"/",b||(b=this._storage[e]+1),this._storage[e]=b}};var p;l.Dropbox=function(a){this.rs=a,this.connected=!1,this.rs=a;var c=this;if(p=function(a){a instanceof RemoteStorage.Unauthorized&&c.configure(null,null,null,null)},l.eventHandling(this,"change","connected","wire-busy","wire-done","not-connected"),a.on("error",p),this.clientId=a.apiKeys.dropbox.api_key,this._revCache=new b("rev"),this._itemRefs={},this._metadataCache={},k){var d;try{d=JSON.parse(localStorage[n])}catch(e){}d&&this.configure(d.userAddress,void 0,void 0,d.token);try{this._itemRefs=JSON.parse(localStorage[n+":shares"])}catch(e){}}this.connected&&setTimeout(this._emit.bind(this),0,"connected")},l.Dropbox.prototype={online:!0,connect:function(){this.rs.setBackend("dropbox"),this.token?i(this.rs):l.Authorize(m,"",String(l.Authorize.getLocation()),this.clientId)},configure:function(a,b,c,d){"undefined"!=typeof d&&(this.token=d),"undefined"!=typeof a&&(this.userAddress=a),this.token?(this.connected=!0,this.userAddress||this.info().then(function(a){this.userAddress=a.display_name}.bind(this)),this._emit("connected")):this.connected=!1,k&&(localStorage[n]=JSON.stringify({token:this.token,userAddress:this.userAddress}))},stopWaitingForToken:function(){this.connected||this._emit("not-connected")},_getFolder:function(a){var b="https://api.dropbox.com/1/metadata/auto"+a,c=promising(),d=this._revCache;return this._request("GET",b,{},function(b,e){if(b)c.reject(b);else{var f=e.status;if(304===f)return void c.fulfill(f);var g,h,i,j;try{h=JSON.parse(e.responseText)}catch(k){return void c.reject(k)}j=this._revCache.get(a),i="application/json; charset=UTF-8",h.contents&&(g=h.contents.reduce(function(b,c){var e=c.path.split("/").slice(-1)[0]+(c.is_dir?"/":"");return b[e]=c.is_dir?{ETag:d.get(a+e)}:{ETag:c.rev},b},{})),c.fulfill(f,g,i,j)}}),c},get:function(a,b){if(!this.connected)throw new Error("not connected (path: "+a+")");a=o(a);var c="https://api-content.dropbox.com/1/files/auto"+a,d=this._sharePromise(a),e=this._revCache.get(a);return null===e?(d.fulfill(404),d):b&&b.ifNoneMatch&&e&&e===b.ifNoneMatch?(d.fulfill(304),d):"/"===a.substr(-1)?this._getFolder(a,b):(this._request("GET",c,{},function(b,c){if(b)d.reject(b);else{var e,f,g,h,i=c.status;if(200===i){f=c.responseText;try{e=JSON.parse(c.getResponseHeader("x-dropbox-metadata"))}catch(j){return void d.reject(j)}if(g=e.mime_type,h=e.rev,this._revCache.set(a,h),!c.getResponseHeader("Content-Type")||c.getResponseHeader("Content-Type").match(/charset=binary/))l.WireClient.readBinaryData(c.response,g,function(a){d.fulfill(i,a,g,h)});else{try{f=JSON.parse(f),g="application/json; charset=UTF-8"}catch(j){}d.fulfill(i,f,g,h)}}else d.fulfill(i)}}),d)},put:function(a,b,c,d){if(!this.connected)throw new Error("not connected (path: "+a+")");var e=a;a=o(a);var f=this,g=this._sharePromise(a),h=this._revCache,i=h.get(a);if(d&&d.ifMatch&&i&&i!==d.ifMatch)return g.fulfill(412,void 0,void 0,i),g;if(d&&"*"===d.ifNoneMatch&&i&&"rev"!==i)return g.fulfill(412,void 0,void 0,i),g;!c.match(/charset=/)&&(b instanceof ArrayBuffer||l.WireClient.isArrayBufferView(b))&&(c+="; charset=binary");var j="https://api-content.dropbox.com/1/files_put/auto"+a+"?";if(d&&d.ifMatch&&(j+="parent_rev="+encodeURIComponent(d.ifMatch)),b.length>157286400)RemoteStorage.log("files larger than 150MB not supported yet");else{var k=promising();d&&(d.ifMatch||"*"===d.ifNoneMatch)?this._getMetadata(e).then(function(a){k.fulfill(a)}):k.fulfill(),k.then(function(i){return d&&"*"===d.ifNoneMatch&&i?void g.fulfill(412,void 0,void 0,i.rev):d&&d.ifMatch&&i&&i.rev!==d.ifMatch?void g.fulfill(412,void 0,void 0,i.rev):void f._request("PUT",j,{body:b,headers:{"Content-Type":c}},function(b,c){if(b)g.reject(b);else if(200===c.status){var d=JSON.parse(c.responseText);if(d.path===e)h.propagateSet(a,d.rev),g.fulfill(c.status);else{var i="https://api.dropbox.com/1/fileops/delete?root=auto&path="+encodeURIComponent(d.path);f._request("POST",i,{},function(){}),f._getMetadata(a).then(function(a){g.fulfill(412,void 0,void 0,a.rev)})}}else g.fulfill(c.status)})})}return g},"delete":function(a,b){if(!this.connected)throw new Error("not connected (path: "+a+")");var c=a;a=o(a);var d=this,e=promising(),f=this._revCache,g=f.get(a);if(b&&b.ifMatch&&g&&b.ifMatch!==g)return e.fulfill(412,void 0,void 0,g),e;var h=promising();return b&&b.ifMatch?this._getMetadata(c).then(function(a){h.fulfill(a)}):h.fulfill(),h.then(function(g){if(b&&b.ifMatch&&g&&g.rev!==b.ifMatch)return void e.fulfill(412,void 0,void 0,g.rev);var h="https://api.dropbox.com/1/fileops/delete?root=auto&path="+encodeURIComponent(c);d._request("POST",h,{},function(b,c){b?e.reject(error):(200===c.status&&f.delete(a),e.fulfill(c.status))})}),e.then(function(){var b=Array.prototype.slice.call(arguments);delete this._itemRefs[a];var c=promising();return c.fulfill.apply(c,b)}.bind(this))},_sharePromise:function(a){var b=promising(),c=this;return a.match(/^\/public\/.*[^\/]$/)&&"undefined"==typeof this._itemRefs[a]&&b.then(function(){var b=Array.prototype.slice.call(arguments),d=promising();return c.share(a).then(function(){d.fulfill.apply(d,b)},function(){d.fulfill.apply(d,b)}),d}),b},share:function(a){var b="https://api.dropbox.com/1/media/auto"+a,c=promising(),d=this._itemRefs;return this._request("POST",b,{},function(b,e){if(b)RemoteStorage.log(b),b.message='Shareing Dropbox Thingie("'+a+'") failed'+b.message,c.reject(b);else try{var f=JSON.parse(e.responseText),g=f.url;d[a]=g,k&&(localStorage[n+":shares"]=JSON.stringify(this._itemRefs)),c.fulfill(g)}catch(b){b.message+="share error",c.reject(b)}}),c},info:function(){var a="https://api.dropbox.com/1/account/info",b=promising();return this._request("GET",a,{},function(a,c){if(a)b.reject(a);else try{var d=JSON.parse(c.responseText);b.fulfill(d)}catch(e){b.reject(a)}}),b},_request:function(b,c,d,e){e=e.bind(this),d.headers||(d.headers={}),d.headers.Authorization="Bearer "+this.token,l.WireClient.request.call(this,b,c,d,function(f,g){g&&503===g.status?a.setTimeout(this._request(b,c,d,e),3210):e(f,g)})},fetchDelta:function(){var a=Array.prototype.slice.call(arguments),c=promising(),d=this;return this._request("POST","https://api.dropbox.com/1/delta",{body:this._deltaCursor?"cursor="+encodeURIComponent(this._deltaCursor):"",headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(e,f){if(e)this.rs.log("fetchDeltas",e),this.rs._emit("error",new RemoteStorage.SyncError("fetchDeltas failed"+e)),c.reject(e);else{if(200!==f.status)return 400===f.status?(this.rs._emit("error",new RemoteStorage.Unauthorized),c.fulfill.apply(c,a)):c.reject("dropbox.fetchDelta returned "+f.status+f.responseText),c;var g;try{g=JSON.parse(f.responseText)}catch(e){return l.log("fetchDeltas can not parse response",e),c.reject("can not parse response of fetchDelta : "+e.message)}if(!g.entries)return c.reject("dropbox.fetchDeltas failed, no entries found");g.reset&&(this._revCache=new b("rev"),c.then(function(){var a=Array.prototype.slice.call(arguments);d._revCache._activatePropagation();var b=promising();return b.fulfill.apply(b,a)})),g.cursor&&(this._deltaCursor=g.cursor),RemoteStorage.log("Delta : ",g.entries),g.entries.forEach(function(a){var b,c=a[0];if(a[1]){if(a[1].is_dir)return;b=a[1].rev}else b=null;d._revCache.set(c,b)}),c.fulfill.apply(c,a)}}),c},_getMetadata:function(a,b){var c=promising(),d=this,e=this._metadataCache[a],f="https://api.dropbox.com/1/metadata/auto"+o(a);return f+="?list="+(b&&b.list?"true":"false"),e&&e.hash&&(f+="&hash="+encodeURIComponent(e.hash)),this._request("GET",f,{},function(b,f){if(b)return void c.reject(b);if(304===f.status)c.fulfill(e);else if(200===f.status){var g=JSON.parse(f.responseText);d._metadataCache[a]=g,c.fulfill(g)}else c.fulfill()}),c}},l.Dropbox._rs_init=function(a){k=a.localStorageAvailable(),a.apiKeys.dropbox&&(a.dropbox=new l.Dropbox(a)),"dropbox"===a.backend&&i(a)},l.Dropbox._rs_supported=function(){return!0},l.Dropbox._rs_cleanup=function(a){j(a),k&&delete localStorage[n],a.removeEventListener("error",p),a.setBackend(void 0)}}(this),remoteStorage=new RemoteStorage,function(){var a="sockethub";RemoteStorage.defineModule(a,function(a){return{exports:{c:a,init:function(){a.declareType("config",{description:"sockethub config file",type:"object",properties:{host:{type:"string",description:"the hostname to connect to",format:"uri",required:!0},port:{type:"number",description:"the port number to connect to",required:!0},path:{type:"string",description:"path portion of the URI, if any",required:!1},tls:{type:"boolean",description:"whether or not to use TLS",required:!1},secret:{type:"string",description:"the secret to identify yourself with the sockethub server",required:!0}}})},getConfig:function(b){return b=b||"default",b="config."+b+".json",a.getObject(b)},writeConfig:function(b,c){if("string"!=typeof b)throw new Error("remotestorage.socketub.writeConfig requires the unique name of config to write as first param  (e.g. writeConfig('default', {...}); )");return b="config."+b+".json",a.storeObject("config",b,c)}}}})}();